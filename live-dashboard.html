<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReportPortal Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --accent-cyan: #06b6d4;
            --accent-green: #22c55e;
            --accent-red: #ef4444;
            --accent-yellow: #eab308;
            --accent-purple: #8b5cf6;
            --accent-orange: #f97316;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --border: #475569;
            --glow-cyan: 0 0 25px rgba(6, 182, 212, 0.35);
            --glow-green: 0 0 25px rgba(34, 197, 94, 0.35);
            --glow-red: 0 0 25px rgba(239, 68, 68, 0.35);
            --glow-purple: 0 0 25px rgba(139, 92, 246, 0.35);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-grid {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: 
                linear-gradient(rgba(0, 240, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 240, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridMove 20s linear infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1900px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0 1rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 45px; height: 45px;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 22px;
            box-shadow: var(--glow-cyan);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: var(--glow-cyan); }
            50% { box-shadow: 0 0 50px rgba(0, 240, 255, 0.6); }
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            background: var(--bg-card);
            padding: 0.5rem;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-bottom: 1.5rem;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: var(--text-secondary);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: var(--bg-hover);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            color: var(--bg-dark);
            box-shadow: var(--glow-cyan);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Suite Report Styles */
        .main-controls {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr auto;
            gap: 1rem;
            align-items: end;
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: 16px;
            border: 1px solid var(--border);
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .form-group select {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--bg-hover);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
        }

        .form-group select:hover { border-color: var(--accent-cyan); }
        .form-group select:focus { outline: none; border-color: var(--accent-cyan); box-shadow: var(--glow-cyan); }

        .select-wrapper {
            position: relative;
        }

        .select-wrapper::after {
            content: 'â–¼';
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            pointer-events: none;
            font-size: 0.7rem;
        }

        .btn-primary {
            padding: 0.875rem 2rem;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            border: none;
            border-radius: 10px;
            color: var(--bg-dark);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary:hover { transform: translateY(-2px); box-shadow: var(--glow-cyan); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        /* Report Card */
        .report-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
            background: rgba(0, 240, 255, 0.02);
        }

        .report-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge.passed { background: rgba(0, 255, 136, 0.15); color: var(--accent-green); border: 1px solid var(--accent-green); }
        .status-badge.failed { background: rgba(255, 56, 96, 0.15); color: var(--accent-red); border: 1px solid var(--accent-red); }

        .report-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            padding: 1.5rem;
        }

        .report-stat {
            text-align: center;
            padding: 1rem;
            background: var(--bg-hover);
            border-radius: 12px;
        }

        .report-stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 700;
        }

        .report-stat-value.total { color: var(--accent-cyan); }
        .report-stat-value.passed { color: var(--accent-green); }
        .report-stat-value.failed { color: var(--accent-red); }
        .report-stat-value.duration { color: var(--accent-orange); }

        .report-stat-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-top: 0.25rem;
        }

        .report-meta {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            padding: 1rem 1.5rem;
            background: var(--bg-hover);
            margin: 0 1.5rem 1.5rem;
            border-radius: 10px;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .meta-label {
            font-size: 0.65rem;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .meta-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-primary);
        }

        .link-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(0, 240, 255, 0.1);
            border: 1px solid var(--accent-cyan);
            border-radius: 6px;
            color: var(--accent-cyan);
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .link-btn:hover { background: rgba(0, 240, 255, 0.2); }

        .failed-tests-panel {
            margin: 0 1.5rem 1.5rem;
            background: rgba(255, 56, 96, 0.05);
            border: 1px solid rgba(255, 56, 96, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .failed-tests-header {
            padding: 1rem 1.25rem;
            border-bottom: 1px solid rgba(255, 56, 96, 0.2);
            font-weight: 600;
            color: var(--accent-red);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .failed-test-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .failed-test-item {
            padding: 0.75rem 1.25rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .failed-test-num {
            width: 28px;
            height: 28px;
            background: rgba(255, 56, 96, 0.2);
            color: var(--accent-red);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            flex-shrink: 0;
        }

        .failed-test-name {
            font-size: 0.85rem;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .loading-state {
            text-align: center;
            padding: 3rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--accent-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

        @media (max-width: 1400px) {
            .main-controls { grid-template-columns: 1fr 1fr; }
        }

        @media (max-width: 768px) {
            .main-controls { grid-template-columns: 1fr; }
            .reports-grid { grid-template-columns: 1fr; }
        }

        .hidden { display: none !important; }

        /* Date Picker Styles for Suite Report */
        .date-picker-wrapper {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .date-picker-input {
            flex: 1;
            padding: 0.875rem 1rem;
            background: var(--bg-hover);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .date-picker-input:hover { border-color: var(--accent-cyan); }
        .date-picker-input:focus { outline: none; border-color: var(--accent-cyan); box-shadow: var(--glow-cyan); }

        .date-picker-input::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }

        .clear-date-btn-inline {
            width: 36px;
            height: 36px;
            background: rgba(255, 56, 96, 0.2);
            color: var(--accent-red);
            border: 1px solid var(--accent-red);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .clear-date-btn-inline:hover {
            background: rgba(255, 56, 96, 0.4);
            transform: scale(1.05);
        }

        /* Multiple Reports List */
        .reports-list {
            margin-top: 1.5rem;
        }

        .reports-list-header {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent-cyan);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1rem;
        }

        .report-card-mini {
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .report-card-mini:hover {
            border-color: var(--accent-cyan);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 240, 255, 0.1);
        }

        .report-card-mini.passed { border-left: 4px solid var(--accent-green); }
        .report-card-mini.failed { border-left: 4px solid var(--accent-red); }
        .report-card-mini.in_progress { border-left: 4px solid var(--accent-yellow); }

        .report-card-mini-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .report-card-mini-title {
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .report-card-mini-status {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .report-card-mini-status.passed { background: rgba(0, 255, 136, 0.15); color: var(--accent-green); }
        .report-card-mini-status.failed { background: rgba(255, 56, 96, 0.15); color: var(--accent-red); }
        .report-card-mini-status.in_progress { background: rgba(255, 221, 0, 0.15); color: var(--accent-yellow); }

        .report-card-mini-stats {
            display: flex;
            gap: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            margin-bottom: 0.5rem;
        }

        .report-card-mini-stats .passed { color: var(--accent-green); }
        .report-card-mini-stats .failed { color: var(--accent-red); }

        .report-card-mini-meta {
            font-size: 0.75rem;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
        }

        .report-card-mini-meta .copy-link-btn {
            width: 24px;
            height: 24px;
            font-size: 0.75rem;
            margin-left: auto;
        }

        .report-card-mini-header .copy-link-btn {
            width: 24px;
            height: 24px;
            font-size: 0.75rem;
        }

        .no-results-message {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
            background: var(--bg-hover);
            border-radius: 12px;
            border: 1px dashed var(--border);
        }

        /* REST API Reports Tab Styles */
        .restapi-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-card);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-bottom: 1.5rem;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .restapi-controls > .back-btn {
            flex-shrink: 0;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .breadcrumb-item {
            padding: 0.5rem 0.75rem;
            background: var(--bg-hover);
            border-radius: 6px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .breadcrumb-item:hover {
            background: rgba(0, 240, 255, 0.1);
            color: var(--accent-cyan);
        }

        .breadcrumb-item.active {
            background: rgba(0, 240, 255, 0.15);
            color: var(--accent-cyan);
            border: 1px solid var(--accent-cyan);
        }

        .breadcrumb-separator {
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        .restapi-filters {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .restapi-search {
            flex: 1;
            max-width: 400px;
        }

        .date-filter {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--bg-hover);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: 2px solid var(--accent);
        }

        .date-filter.hidden {
            display: none;
        }

        .date-filter-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            white-space: nowrap;
        }

        .date-input {
            padding: 0.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text);
            font-size: 0.9rem;
            cursor: pointer;
        }

        .date-input::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }

        .clear-date-btn {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .clear-date-btn:hover {
            background: #dc2626;
            transform: scale(1.1);
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-hover);
            border: 2px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: var(--glow-cyan);
        }

        .restapi-content {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .restapi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }

        .restapi-card {
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .restapi-card:hover {
            border-color: var(--accent-cyan);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 240, 255, 0.1);
        }

        .restapi-card.directory {
            border-left: 3px solid var(--accent-purple);
        }

        .restapi-card.report {
            border-left: 3px solid var(--accent-green);
        }

        .restapi-card-icon {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .restapi-card.directory .restapi-card-icon {
            background: rgba(189, 0, 255, 0.15);
        }

        .restapi-card.report .restapi-card-icon {
            background: rgba(0, 255, 136, 0.15);
        }

        .restapi-card-info {
            flex: 1;
            overflow: hidden;
        }

        .restapi-card-name {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .restapi-card-meta {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .restapi-report {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .report-viewer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: var(--bg-hover);
            border-bottom: 1px solid var(--border);
        }

        .back-btn {
            padding: 0.5rem 1rem;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .report-frame {
            width: 100%;
            height: calc(100vh - 300px);
            min-height: 500px;
            border: none;
            background: #fff;
        }

        /* Recent reports section */
        .recent-reports {
            margin-top: 1.5rem;
        }

        .recent-reports-header {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent-orange);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .recent-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1rem;
        }

        .recent-item {
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .recent-item:hover {
            border-color: var(--accent-orange);
            background: rgba(255, 149, 0, 0.05);
        }

        .recent-icon {
            width: 36px;
            height: 36px;
            background: rgba(255, 149, 0, 0.15);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .recent-info h5 {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.15rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 280px;
        }

        .recent-info span {
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        /* API Owners Tab Styles */
        .owner-controls {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr auto;
            gap: 1rem;
            align-items: end;
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: 16px;
            border: 1px solid var(--border);
            margin-bottom: 1.5rem;
        }

        @media (max-width: 1200px) {
            .owner-controls {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .owner-controls {
                grid-template-columns: 1fr;
            }
        }

        .owner-suites-container {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .owner-suites-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(0, 240, 255, 0.05), rgba(189, 0, 255, 0.05));
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 1rem;
        }

        .owner-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .owner-avatar {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            box-shadow: var(--glow-cyan);
        }

        .owner-details h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .owner-stats {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .owner-summary {
            display: flex;
            gap: 1.5rem;
        }

        .summary-stat {
            text-align: center;
            padding: 0.75rem 1.25rem;
            background: var(--bg-hover);
            border-radius: 10px;
            min-width: 80px;
        }

        .summary-stat.passed { border: 1px solid var(--accent-green); }
        .summary-stat.failed { border: 1px solid var(--accent-red); }
        .summary-stat.total { border: 1px solid var(--accent-cyan); }

        .summary-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            display: block;
        }

        .summary-stat.passed .summary-value { color: var(--accent-green); }
        .summary-stat.failed .summary-value { color: var(--accent-red); }
        .summary-stat.total .summary-value { color: var(--accent-cyan); }

        .summary-label {
            font-size: 0.65rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .owner-suites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 1rem;
            padding: 1.5rem;
        }

        .owner-suite-card {
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .owner-suite-card:hover {
            border-color: var(--accent-cyan);
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 240, 255, 0.15);
        }

        .owner-suite-card.passed { border-left: 4px solid var(--accent-green); }
        .owner-suite-card.failed { border-left: 4px solid var(--accent-red); }
        .owner-suite-card.in_progress { border-left: 4px solid var(--accent-yellow); }
        .owner-suite-card.has-report { border-left: 4px solid var(--accent-green); }
        .owner-suite-card.no-runs { border-left: 4px solid var(--text-muted); opacity: 0.7; }

        .owner-suite-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .owner-suite-name {
            font-weight: 600;
            font-size: 0.95rem;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .owner-suite-name .suite-category {
            font-size: 0.7rem;
            color: var(--accent-purple);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .owner-suite-status {
            padding: 0.25rem 0.6rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            flex-shrink: 0;
        }

        .owner-suite-status.passed { background: rgba(0, 255, 136, 0.15); color: var(--accent-green); }
        .owner-suite-status.failed { background: rgba(255, 56, 96, 0.15); color: var(--accent-red); }
        .owner-suite-status.in_progress { background: rgba(255, 221, 0, 0.15); color: var(--accent-yellow); }
        .owner-suite-status.no-runs { background: rgba(122, 133, 153, 0.15); color: var(--text-secondary); }

        .owner-suite-stats {
            display: flex;
            gap: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            margin-bottom: 0.75rem;
        }

        .owner-suite-stats .passed { color: var(--accent-green); }
        .owner-suite-stats .failed { color: var(--accent-red); }
        .owner-suite-stats .total { color: var(--text-secondary); }

        .owner-suite-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--text-secondary);
            padding-top: 0.75rem;
            border-top: 1px solid var(--border);
        }

        .owner-suite-meta span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .owner-detail-card {
            margin-top: 1.5rem;
        }

        .no-owner-suites {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .no-owner-suites-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .direct-report-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background: rgba(0, 240, 255, 0.15);
            border: 1px solid var(--accent-cyan);
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            margin-left: auto;
        }

        .direct-report-link:hover {
            background: rgba(0, 240, 255, 0.3);
            transform: scale(1.1);
            box-shadow: var(--glow-cyan);
        }

        .copy-link-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background: rgba(138, 43, 226, 0.15);
            border: 1px solid var(--accent-purple);
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-left: 6px;
        }

        .copy-link-btn:hover {
            background: rgba(138, 43, 226, 0.3);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
        }

        .copy-link-btn.copied {
            background: rgba(0, 255, 136, 0.3);
            border-color: var(--accent-green);
        }

        .report-action-buttons {
            display: flex;
            align-items: center;
            margin-left: auto;
            gap: 4px;
        }

        /* Toast notification */
        .toast-notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 24px;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.9), rgba(0, 200, 100, 0.9));
            color: #000;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            z-index: 10000;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 255, 136, 0.4);
        }

        .toast-notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .owner-suite-card {
            cursor: pointer;
        }

        .owner-suite-card.no-runs {
            cursor: default;
        }

        /* Suite Management Tab Styles */
        .suite-mgmt-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 1.5rem;
        }

        @media (max-width: 1200px) {
            .suite-mgmt-container {
                grid-template-columns: 1fr;
            }
        }

        .suite-mgmt-form-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            height: fit-content;
        }

        .suite-mgmt-form-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .suite-mgmt-form-header h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .suite-mgmt-form-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .suite-form-group {
            margin-bottom: 1.25rem;
        }

        .suite-form-group label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .suite-form-group label .required {
            color: var(--accent-red);
            margin-left: 2px;
        }

        .suite-form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--bg-hover);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .suite-form-input:hover {
            border-color: var(--accent-cyan);
        }

        .suite-form-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: var(--glow-cyan);
        }

        .suite-form-input::placeholder {
            color: var(--text-muted);
        }

        .suite-form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        @media (max-width: 600px) {
            .suite-form-row {
                grid-template-columns: 1fr;
            }
        }

        .suite-form-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .btn-add-suite {
            flex: 1;
            padding: 0.875rem 1.5rem;
            background: linear-gradient(135deg, var(--accent-green), #059669);
            border: none;
            border-radius: 10px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-add-suite:hover {
            transform: translateY(-2px);
            box-shadow: var(--glow-green);
        }

        .btn-add-suite:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-clear-form {
            padding: 0.875rem 1.5rem;
            background: transparent;
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-secondary);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-clear-form:hover {
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        /* Suites List Panel */
        .suite-mgmt-list-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .suite-mgmt-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 1.5rem;
            background: linear-gradient(135deg, rgba(0, 240, 255, 0.05), rgba(189, 0, 255, 0.05));
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 1rem;
        }

        .suite-mgmt-list-header h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .suite-mgmt-list-actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .suite-search-input {
            padding: 0.5rem 1rem;
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.85rem;
            width: 200px;
            transition: all 0.3s ease;
        }

        .suite-search-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        .suite-count-badge {
            padding: 0.35rem 0.75rem;
            background: var(--accent-purple);
            color: white;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .btn-export-suites,
        .btn-import-suites {
            padding: 0.5rem 1rem;
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .btn-export-suites:hover,
        .btn-import-suites:hover {
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        /* Suites Table */
        .suite-mgmt-table-container {
            max-height: calc(100vh - 350px);
            overflow-y: auto;
        }

        .suite-mgmt-table {
            width: 100%;
            border-collapse: collapse;
        }

        .suite-mgmt-table th {
            position: sticky;
            top: 0;
            background: var(--bg-hover);
            padding: 0.875rem 1rem;
            text-align: left;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--border);
            z-index: 1;
        }

        .suite-mgmt-table td {
            padding: 0.875rem 1rem;
            border-bottom: 1px solid var(--border);
            font-size: 0.85rem;
        }

        .suite-mgmt-table tr:hover {
            background: rgba(6, 182, 212, 0.05);
        }

        .suite-folder-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.25rem 0.6rem;
            background: rgba(139, 92, 246, 0.15);
            color: var(--accent-purple);
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .suite-subfolder-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.25rem 0.6rem;
            background: rgba(6, 182, 212, 0.15);
            color: var(--accent-cyan);
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .owner-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.25rem 0.6rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .owner-badge.api {
            background: rgba(34, 197, 94, 0.15);
            color: var(--accent-green);
        }

        .owner-badge.ui {
            background: rgba(249, 115, 22, 0.15);
            color: var(--accent-orange);
        }

        .suite-actions-cell {
            display: flex;
            gap: 0.5rem;
        }

        .btn-edit-suite,
        .btn-delete-suite {
            width: 30px;
            height: 30px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .btn-edit-suite {
            background: rgba(6, 182, 212, 0.15);
            color: var(--accent-cyan);
        }

        .btn-edit-suite:hover {
            background: rgba(6, 182, 212, 0.3);
            transform: scale(1.1);
        }

        .btn-delete-suite {
            background: rgba(239, 68, 68, 0.15);
            color: var(--accent-red);
        }

        .btn-delete-suite:hover {
            background: rgba(239, 68, 68, 0.3);
            transform: scale(1.1);
        }

        .suite-empty-table {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }

        .suite-empty-table-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Filter Tags */
        .suite-filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            background: var(--bg-hover);
        }

        .filter-tag {
            padding: 0.35rem 0.75rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-tag:hover,
        .filter-tag.active {
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
            background: rgba(6, 182, 212, 0.1);
        }

        .filter-tag.active {
            background: rgba(6, 182, 212, 0.2);
        }

        /* Import Modal */
        .import-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .import-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .import-modal-content {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            width: 90%;
            max-width: 500px;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .import-modal.show .import-modal-content {
            transform: scale(1);
        }

        .import-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .import-modal-header h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
        }

        .import-modal-close {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .import-modal-close:hover {
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .import-textarea {
            width: 100%;
            height: 200px;
            background: var(--bg-hover);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            resize: vertical;
        }

        .import-textarea:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        .import-modal-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        /* Main Folder Autocomplete */
        .autocomplete-wrapper {
            position: relative;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border: 2px solid var(--accent-cyan);
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .autocomplete-dropdown.show {
            display: block;
        }

        .autocomplete-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            border-bottom: 1px solid var(--border);
            transition: all 0.2s ease;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover,
        .autocomplete-item.highlighted {
            background: rgba(6, 182, 212, 0.15);
            color: var(--accent-cyan);
        }

        .autocomplete-item-icon {
            font-size: 1rem;
        }

        .autocomplete-item-text {
            flex: 1;
        }

        .autocomplete-item-count {
            font-size: 0.7rem;
            color: var(--text-muted);
            background: var(--bg-hover);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .autocomplete-no-match {
            padding: 1rem;
            text-align: center;
            color: var(--accent-red);
            font-size: 0.85rem;
        }

        .autocomplete-no-match-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .input-validation-error {
            border-color: var(--accent-red) !important;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.3) !important;
        }

        .input-validation-success {
            border-color: var(--accent-green) !important;
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.3) !important;
        }

        .validation-message {
            font-size: 0.75rem;
            margin-top: 0.35rem;
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .validation-message.error {
            color: var(--accent-red);
        }

        .validation-message.success {
            color: var(--accent-green);
        }

        /* Sortable Table Headers */
        .suite-mgmt-table th.sortable {
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
        }

        .suite-mgmt-table th.sortable:hover {
            color: var(--accent-cyan);
            background: rgba(6, 182, 212, 0.1);
        }

        .suite-mgmt-table th.sortable::after {
            content: ' â†•';
            opacity: 0.3;
            font-size: 0.7rem;
        }

        .suite-mgmt-table th.sortable.asc::after {
            content: ' â†‘';
            opacity: 1;
            color: var(--accent-cyan);
        }

        .suite-mgmt-table th.sortable.desc::after {
            content: ' â†“';
            opacity: 1;
            color: var(--accent-cyan);
        }

        /* Suite Stats Summary */
        .suite-stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            background: var(--bg-hover);
            border-bottom: 1px solid var(--border);
        }

        .suite-stat-item {
            text-align: center;
            padding: 0.75rem;
            background: var(--bg-card);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .suite-stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-cyan);
        }

        .suite-stat-label {
            font-size: 0.65rem;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 0.25rem;
        }

        /* Delete Confirmation Modal */
        .delete-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .delete-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .delete-modal-content {
            background: var(--bg-card);
            border: 1px solid var(--accent-red);
            border-radius: 16px;
            padding: 1.5rem;
            width: 90%;
            max-width: 400px;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .delete-modal.show .delete-modal-content {
            transform: scale(1);
        }

        .delete-modal-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .delete-modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--accent-red);
        }

        .delete-modal-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        .delete-modal-suite {
            background: var(--bg-hover);
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
        }

        .delete-modal-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
        }

        .btn-confirm-delete {
            padding: 0.75rem 1.5rem;
            background: var(--accent-red);
            border: none;
            border-radius: 8px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-confirm-delete:hover {
            background: #dc2626;
            transform: scale(1.05);
        }

        .btn-cancel-delete {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-cancel-delete:hover {
            border-color: var(--text-primary);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">ðŸ“Š</div>
                <h1>ReportPortal</h1>
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="main">
                <span>ðŸ”</span> Suite Report
            </button>
            <button class="tab-btn" data-tab="owner">
                <span>ðŸ”Œ</span> API Owners
            </button>
            <button class="tab-btn" data-tab="uiowner">
                <span>ðŸ–¥ï¸</span> UI Owners
            </button>
            <button class="tab-btn" data-tab="restapi">
                <span>ðŸ—‚ï¸</span> REST API Reports
            </button>
            <button class="tab-btn" data-tab="suitemgmt">
                <span>âš™ï¸</span> API Suite Management
            </button>
        </div>

        <!-- Suite Report Tab -->
        <div class="tab-content active" id="mainTab">
            <div class="main-controls">
                <div class="form-group">
                    <label>Environment</label>
                    <div class="select-wrapper">
                        <select id="envSelect">
                            <option value="staging_suites">QA Staging</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Test Suite</label>
                    <div class="select-wrapper">
                        <select id="suiteSelect">
                            <option value="">-- Select a Test Suite --</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Filter by Date</label>
                    <div class="date-picker-wrapper">
                        <input type="date" id="suiteReportDateFilter" class="date-picker-input">
                        <button id="clearSuiteDateFilter" class="clear-date-btn-inline" title="Clear date">âœ•</button>
                    </div>
                </div>
                <button class="btn-primary" id="fetchReportBtn" disabled>
                    <span>ðŸ”</span> Get Report
                </button>
            </div>

            <div id="mainEmptyState" class="empty-state">
                <div class="empty-state-icon">ðŸ“‹</div>
                <h3>Select a Test Suite</h3>
                <p>Choose an environment, test suite, and optionally a date to view reports</p>
            </div>

            <div id="mainLoadingState" class="loading-state hidden">
                <div class="spinner"></div>
                <p>Fetching reports...</p>
            </div>

            <!-- Multiple Reports List (shown when date filter is active) -->
            <div id="reportsListContainer" class="reports-list hidden">
                <div class="reports-list-header">
                    <span>ðŸ“Š</span> <span id="reportsListTitle">Reports</span>
                </div>
                <div class="reports-grid" id="reportsGrid"></div>
            </div>

            <div id="mainReportCard" class="report-card hidden">
                <div class="report-header">
                    <button class="back-btn hidden" id="backToReportsList" style="margin-right: 1rem;">â† Back to List</button>
                    <div class="report-title" id="reportSuiteName">-</div>
                    <div class="status-badge" id="reportStatus">-</div>
                </div>
                <div class="report-stats">
                    <div class="report-stat"><div class="report-stat-value total" id="reportTotal">0</div><div class="report-stat-label">Total Tests</div></div>
                    <div class="report-stat"><div class="report-stat-value passed" id="reportPassed">0</div><div class="report-stat-label">Passed</div></div>
                    <div class="report-stat"><div class="report-stat-value failed" id="reportFailed">0</div><div class="report-stat-label">Failed</div></div>
                    <div class="report-stat"><div class="report-stat-value duration" id="reportDuration">0m</div><div class="report-stat-label">Duration</div></div>
                </div>
                <div class="report-meta">
                    <div class="meta-item"><span class="meta-label">Launch ID</span><span class="meta-value" id="reportLaunchId">-</span></div>
                    <div class="meta-item"><span class="meta-label">Run Number</span><span class="meta-value" id="reportRunNumber">-</span></div>
                    <div class="meta-item"><span class="meta-label">Build Date</span><span class="meta-value" id="reportBuildDate">-</span></div>
                    <div class="meta-item"><span class="meta-label">Owner</span><span class="meta-value" id="reportOwner">-</span></div>
                    <div class="meta-item"><span class="meta-label">Platform</span><span class="meta-value" id="reportPlatform">-</span></div>
                    <div class="meta-item"><span class="meta-label">Actions</span><a href="#" class="link-btn" id="reportLink" target="_blank">ðŸ”— View in ReportPortal</a></div>
                </div>
                <div class="failed-tests-panel hidden" id="reportFailedPanel">
                    <div class="failed-tests-header"><span>âŒ</span> Failed Test Cases</div>
                    <div class="failed-test-list" id="reportFailedList"></div>
                </div>
            </div>
        </div>

        <!-- API Owners Tab -->
        <div class="tab-content" id="ownerTab">
            <div class="owner-controls">
                <div class="form-group">
                    <label>Environment</label>
                    <div class="select-wrapper">
                        <select id="ownerEnvSelect">
                            <option value="staging">Staging</option>
                            <option value="qa">QA</option>
                            <option value="iaqa">IAQA</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Owner</label>
                    <div class="select-wrapper">
                        <select id="ownerSelect">
                            <option value="">-- Select an API Owner --</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Filter by Date</label>
                    <div class="date-picker-wrapper">
                        <input type="date" id="ownerDateFilter" class="date-picker-input">
                        <button id="clearOwnerDateFilter" class="clear-date-btn-inline" title="Clear date">âœ•</button>
                    </div>
                </div>
                <button class="btn-primary" id="fetchOwnerSuitesBtn" disabled>
                    <span>ðŸ”</span> Get Suites
                </button>
            </div>

            <div id="ownerEmptyState" class="empty-state">
                <div class="empty-state-icon">ðŸ”Œ</div>
                <h3>Select an API Owner</h3>
                <p>Choose an environment, API owner, and optionally a date to view their REST API test suites</p>
            </div>

            <div id="ownerLoadingState" class="loading-state hidden">
                <div class="spinner"></div>
                <p>Fetching owner suites...</p>
            </div>

            <div id="ownerSuitesContainer" class="owner-suites-container hidden">
                <div class="owner-suites-header">
                    <div class="owner-info">
                        <span class="owner-avatar">ðŸ‘¤</span>
                        <div class="owner-details">
                            <h3 id="selectedOwnerName">-</h3>
                            <span id="selectedOwnerStats" class="owner-stats">-</span>
                        </div>
                    </div>
                    <div class="owner-summary">
                        <div class="summary-stat passed">
                            <span class="summary-value" id="ownerPassedCount">0</span>
                            <span class="summary-label">With Reports</span>
                        </div>
                        <div class="summary-stat failed">
                            <span class="summary-value" id="ownerFailedCount">0</span>
                            <span class="summary-label">No Reports</span>
                        </div>
                        <div class="summary-stat total">
                            <span class="summary-value" id="ownerTotalCount">0</span>
                            <span class="summary-label">Total Suites</span>
                        </div>
                    </div>
                </div>
                <div class="owner-suites-grid" id="ownerSuitesGrid"></div>
            </div>

            <!-- Owner Suite Detail Modal -->
            <div id="ownerSuiteDetailCard" class="report-card hidden owner-detail-card">
                <div class="report-header">
                    <button class="back-btn" id="backToOwnerSuites">â† Back to API Owners</button>
                    <div class="report-title" id="ownerDetailSuiteName">-</div>
                    <div class="status-badge" id="ownerDetailStatus">-</div>
                </div>
                <div class="report-stats">
                    <div class="report-stat"><div class="report-stat-value total" id="ownerDetailTotal">0</div><div class="report-stat-label">Total Tests</div></div>
                    <div class="report-stat"><div class="report-stat-value passed" id="ownerDetailPassed">0</div><div class="report-stat-label">Passed</div></div>
                    <div class="report-stat"><div class="report-stat-value failed" id="ownerDetailFailed">0</div><div class="report-stat-label">Failed</div></div>
                    <div class="report-stat"><div class="report-stat-value duration" id="ownerDetailDuration">0m</div><div class="report-stat-label">Duration</div></div>
                </div>
                <div class="report-meta">
                    <div class="meta-item"><span class="meta-label">Launch ID</span><span class="meta-value" id="ownerDetailLaunchId">-</span></div>
                    <div class="meta-item"><span class="meta-label">Run Number</span><span class="meta-value" id="ownerDetailRunNumber">-</span></div>
                    <div class="meta-item"><span class="meta-label">Build Date</span><span class="meta-value" id="ownerDetailBuildDate">-</span></div>
                    <div class="meta-item"><span class="meta-label">Owner</span><span class="meta-value" id="ownerDetailOwner">-</span></div>
                    <div class="meta-item"><span class="meta-label">Platform</span><span class="meta-value" id="ownerDetailPlatform">-</span></div>
                    <div class="meta-item"><span class="meta-label">Actions</span><a href="#" class="link-btn" id="ownerDetailLink" target="_blank">ðŸ”— View in ReportPortal</a></div>
                </div>
                <div class="failed-tests-panel hidden" id="ownerDetailFailedPanel">
                    <div class="failed-tests-header"><span>âŒ</span> Failed Test Cases</div>
                    <div class="failed-test-list" id="ownerDetailFailedList"></div>
                </div>
            </div>
        </div>

        <!-- REST API Reports Tab -->
        
        <!-- UI Owners Tab -->
        <div class="tab-content" id="uiownerTab">
            <div class="owner-controls">
                <div class="form-group">
                    <label>Environment</label>
                    <div class="select-wrapper">
                        <select id="uiOwnerEnvSelect">
                            <option value="staging">Staging</option>
                            <option value="qa">QA</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Owner</label>
                    <div class="select-wrapper">
                        <select id="uiOwnerSelect">
                            <option value="">-- Select a UI Owner --</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Filter by Date</label>
                    <div class="date-picker-wrapper">
                        <input type="date" id="uiOwnerDateFilter" class="date-picker-input">
                        <button id="clearUiOwnerDateFilter" class="clear-date-btn-inline" title="Clear date">âœ•</button>
                    </div>
                </div>
                <button class="btn-primary" id="fetchUiOwnerSuitesBtn" disabled>
                    <span>ðŸ”</span> Get Suites
                </button>
            </div>

            <div id="uiOwnerEmptyState" class="empty-state">
                <div class="empty-state-icon">ðŸ–¥ï¸</div>
                <h3>Select a UI Owner</h3>
                <p>Choose an environment, UI owner, and optionally a date to view their UI test suites</p>
            </div>

            <div id="uiOwnerLoadingState" class="loading-state hidden">
                <div class="spinner"></div>
                <p>Fetching UI owner suites...</p>
            </div>

            <div id="uiOwnerSuitesContainer" class="owner-suites-container hidden">
                <div class="owner-suites-header">
                    <div class="owner-info">
                        <span class="owner-avatar">ðŸ‘¤</span>
                        <div class="owner-details">
                            <h3 id="selectedUiOwnerName">-</h3>
                            <span id="selectedUiOwnerStats" class="owner-stats">-</span>
                        </div>
                    </div>
                    <div class="owner-summary">
                        <div class="summary-stat passed">
                            <span class="summary-value" id="uiOwnerPassedCount">0</span>
                            <span class="summary-label">With Reports</span>
                        </div>
                        <div class="summary-stat failed">
                            <span class="summary-value" id="uiOwnerFailedCount">0</span>
                            <span class="summary-label">No Reports</span>
                        </div>
                        <div class="summary-stat total">
                            <span class="summary-value" id="uiOwnerTotalCount">0</span>
                            <span class="summary-label">Total Suites</span>
                        </div>
                    </div>
                </div>
                <div class="owner-suites-grid" id="uiOwnerSuitesGrid"></div>
            </div>
        </div>

        <div class="tab-content" id="restapiTab">
            <div class="restapi-controls">
                <button class="back-btn hidden" id="restapiBackBtn">â† Back</button>
                <div class="breadcrumb" id="breadcrumb">
                    <span class="breadcrumb-item" data-path="/">ðŸ  Home</span>
                </div>
                <div class="restapi-filters">
                    <div class="restapi-search">
                        <input type="text" id="restapiSearch" placeholder="ðŸ” Search projects..." class="search-input">
                    </div>
                    <div class="date-filter hidden" id="dateFilterContainer">
                        <label class="date-filter-label">ðŸ“… Filter by Date:</label>
                        <input type="date" id="dateFilter" class="date-input">
                        <button id="clearDateFilter" class="clear-date-btn" title="Clear date filter">âœ•</button>
                    </div>
                </div>
            </div>

            <div id="restapiLoading" class="loading-state">
                <div class="spinner"></div>
                <p>Loading directories...</p>
            </div>

            <div id="restapiContent" class="restapi-content hidden">
                <div class="restapi-grid" id="restapiGrid"></div>
            </div>

            <div id="restapiReport" class="restapi-report hidden">
                <div class="report-viewer">
                    <div class="report-viewer-header">
                        <button class="back-btn" id="backToList">â† Back to List</button>
                        <a href="#" id="openInNewTab" target="_blank" class="link-btn">ðŸ”— Open Report</a>
                    </div>
                    <iframe id="reportFrame" class="report-frame"></iframe>
                </div>
            </div>
        </div>

        <!-- Suite Management Tab -->
        <div class="tab-content" id="suitemgmtTab">
            <div class="suite-mgmt-container">
                <!-- Add/Edit Suite Form -->
                <div class="suite-mgmt-form-panel">
                    <div class="suite-mgmt-form-header">
                        <div class="suite-mgmt-form-icon">âž•</div>
                        <h3 id="suiteFormTitle">Add New API Suite</h3>
                    </div>
                    
                    <form id="suiteManagementForm">
                        <div class="suite-form-group">
                            <label>Main Folder <span class="required">*</span></label>
                            <div class="autocomplete-wrapper">
                                <input type="text" class="suite-form-input" id="mainFolderInput" 
                                       placeholder="Start typing to search existing folders..." 
                                       autocomplete="off" required>
                                <div class="autocomplete-dropdown" id="mainFolderDropdown"></div>
                            </div>
                            <div class="validation-message" id="mainFolderValidation"></div>
                        </div>
                        
                        <div class="suite-form-group">
                            <label>Sub Folder / Suite Name <span class="required">*</span></label>
                            <input type="text" class="suite-form-input" id="subFolderInput" 
                                   placeholder="e.g., API_BUILDER_ADAPTOR, MFA" required>
                        </div>
                        
                        <div class="suite-form-group">
                            <label>API Owner <span class="required">*</span></label>
                            <div class="autocomplete-wrapper">
                                <input type="text" class="suite-form-input" id="apiOwnerInput" 
                                       placeholder="Start typing to search owners..." 
                                       autocomplete="off" required>
                                <div class="autocomplete-dropdown" id="apiOwnerDropdown"></div>
                            </div>
                            <div class="validation-message" id="apiOwnerSuggestion"></div>
                        </div>
                        
                        <div class="suite-form-group">
                            <label>Team / Category</label>
                            <input type="text" class="suite-form-input" id="teamInput" 
                                   placeholder="e.g., Aurora, Core, Integration">
                        </div>
                        
                        <div class="suite-form-group">
                            <label>Description</label>
                            <input type="text" class="suite-form-input" id="descriptionInput" 
                                   placeholder="Brief description of the test suite">
                        </div>
                        
                        <input type="hidden" id="editSuiteId" value="">
                        
                        <div class="suite-form-actions">
                            <button type="submit" class="btn-add-suite" id="submitSuiteBtn">
                                <span>âž•</span> Add Suite
                            </button>
                            <button type="button" class="btn-clear-form" id="clearFormBtn">
                                Clear
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Suites List -->
                <div class="suite-mgmt-list-panel">
                    <div class="suite-mgmt-list-header">
                        <h3>ðŸ”Œ Registered API Suites <span class="suite-count-badge" id="suiteCountBadge">0</span></h3>
                        <div class="suite-mgmt-list-actions">
                            <input type="text" class="suite-search-input" id="suiteSearchInput" 
                                   placeholder="ðŸ” Search API suites...">
                            <button class="btn-export-suites" id="exportSuitesBtn" title="Export as JSON">
                                ðŸ“¤ Export
                            </button>
                            <button class="btn-import-suites" id="importSuitesBtn" title="Import from JSON">
                                ðŸ“¥ Import
                            </button>
                        </div>
                    </div>
                    
                    <!-- Stats Summary -->
                    <div class="suite-stats-summary" id="suiteStatsSummary">
                        <div class="suite-stat-item">
                            <div class="suite-stat-value" id="statTotalSuites">0</div>
                            <div class="suite-stat-label">Total Suites</div>
                        </div>
                        <div class="suite-stat-item">
                            <div class="suite-stat-value" id="statTotalFolders">0</div>
                            <div class="suite-stat-label">Folders</div>
                        </div>
                        <div class="suite-stat-item">
                            <div class="suite-stat-value" id="statTotalOwners">0</div>
                            <div class="suite-stat-label">Owners</div>
                        </div>
                    </div>

                    <!-- Filter Tags -->
                    <div class="suite-filter-tags" id="suiteFilterTags">
                        <span class="filter-tag active" data-filter="all">All</span>
                    </div>

                    <div class="suite-mgmt-table-container">
                        <table class="suite-mgmt-table">
                            <thead>
                                <tr>
                                    <th class="sortable" data-sort="mainFolder">Main Folder</th>
                                    <th class="sortable" data-sort="subFolder">Sub Folder</th>
                                    <th class="sortable" data-sort="apiOwner">API Owner</th>
                                    <th class="sortable" data-sort="team">Team</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="suitesTableBody">
                                <tr>
                                    <td colspan="5">
                                        <div class="suite-empty-table">
                                            <div class="suite-empty-table-icon">ðŸ“­</div>
                                            <h4>No API Suites Registered Yet</h4>
                                            <p>Use the form to add your first API test suite</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div class="delete-modal" id="deleteModal">
            <div class="delete-modal-content">
                <div class="delete-modal-icon">ðŸ—‘ï¸</div>
                <div class="delete-modal-title">Delete Suite?</div>
                <div class="delete-modal-text">This action cannot be undone.</div>
                <div class="delete-modal-suite" id="deleteSuiteInfo">-</div>
                <div class="delete-modal-actions">
                    <button class="btn-confirm-delete" id="confirmDeleteBtn">Delete</button>
                    <button class="btn-cancel-delete" id="cancelDeleteBtn">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Import Modal -->
        <div class="import-modal" id="importModal">
            <div class="import-modal-content">
                <div class="import-modal-header">
                    <h3>ðŸ“¥ Import API Suites from JSON</h3>
                    <button class="import-modal-close" id="closeImportModal">âœ•</button>
                </div>
                <textarea class="import-textarea" id="importTextarea" 
                          placeholder='Paste JSON array here, e.g.:
[
  {
    "mainFolder": "api_execution",
    "subFolder": "API_BUILDER",
    "apiOwner": "John",
    "team": "Core"
  }
]'></textarea>
                <div class="import-modal-actions">
                    <button class="btn-add-suite" id="confirmImportBtn">
                        <span>ðŸ“¥</span> Import Suites
                    </button>
                    <button class="btn-clear-form" id="cancelImportBtn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const CONFIG = {
            RP_HOST: window.location.origin,
            RP_PROJECT: 'staging_suites',
            RP_DIRECT: 'https://reportportal.qa.staging.integrator.io'
        };

        // Copy report link to clipboard
        function copyReportLink(url, event) {
            event.stopPropagation();
            
            // Capture button reference before async operation
            const btn = event.currentTarget || event.target;
            
            // Remove auth credentials from URL for sharing (strip username:password@ pattern)
            const cleanUrl = url.replace(/https?:\/\/[^:]+:[^@]+@/, 'https://');
            
            navigator.clipboard.writeText(cleanUrl).then(() => {
                showToast('ðŸ“‹ Link copied to clipboard!');
                
                // Visual feedback on button
                if (btn) {
                    btn.classList.add('copied');
                    btn.innerHTML = 'âœ“';
                    setTimeout(() => {
                        btn.classList.remove('copied');
                        btn.innerHTML = 'ðŸ“‹';
                    }, 1500);
                }
            }).catch(err => {
                console.error('Failed to copy:', err);
                showToast('âŒ Failed to copy link');
            });
        }

        // Open report link (async version for onclick handlers)
        async function openReportLink(event, reportPath) {
            event.preventDefault();
            event.stopPropagation();
            const url = await buildAuthUrl(REST_REPORTS_CONFIG.directUrl, reportPath);
            if (url) {
                window.open(url, '_blank');
            }
        }

        // Copy report link by path (async version)
        async function copyReportLinkByPath(reportPath, event) {
            event.stopPropagation();
            const btn = event.currentTarget || event.target;
            
            const url = await buildAuthUrl(REST_REPORTS_CONFIG.directUrl, reportPath);
            if (url) {
                copyReportLink(url, event);
            }
        }

        // Show toast notification
        function showToast(message) {
            // Remove existing toast if any
            const existingToast = document.querySelector('.toast-notification');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.className = 'toast-notification';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Trigger animation
            requestAnimationFrame(() => {
                toast.classList.add('show');
            });
            
            // Remove after delay
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 2500);
        }

        let allSuites = [];
        let currentProject = 'staging_suites';
        
        // Cache suites per environment to avoid re-fetching
        const suitesCache = {};

        document.addEventListener('DOMContentLoaded', async () => {
            setupTabs();
            await loadEnvironments();
            await setupMainDashboard();
        });

        // Load available environments/projects (only QA, IAQA, Staging)
        async function loadEnvironments() {
            const envSelect = document.getElementById('envSelect');
            
            // Only these 3 environments
            const environments = [
                { value: 'staging_suites', name: 'Staging' },
                { value: 'qa_suites', name: 'QA' },
                { value: 'iaqa_suites', name: 'IAQA' }
            ];
            
            envSelect.innerHTML = environments.map(env => {
                const selected = env.value === currentProject ? 'selected' : '';
                return `<option value="${env.value}" ${selected}>${env.name}</option>`;
            }).join('');

            // Handle environment change
            envSelect.addEventListener('change', async () => {
                currentProject = envSelect.value;
                CONFIG.RP_PROJECT = currentProject;
                await setupMainDashboard();
            });
        }

        // Initialize REST API Reports when tab is first shown
        let restApiInitialized = false;

        // Tab Navigation with lazy initialization
        function setupTabs() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(btn.dataset.tab + 'Tab').classList.add('active');

                    // Initialize REST API reports on first view
                    if (btn.dataset.tab === 'restapi' && !restApiInitialized) {
                        restApiInitialized = true;
                        setupRestApiReportsListeners();
                        initRestApiReports();
                    }
                });
            });
        }

        // ==================== SUITE REPORT ====================
        async function setupMainDashboard() {
            const suiteSelect = document.getElementById('suiteSelect');
            const fetchBtn = document.getElementById('fetchReportBtn');
            const project = currentProject;

            console.log(`Setting up dashboard for project: ${project}`);

            // Check cache first
            if (suitesCache[project]) {
                console.log(`Using cached suites for ${project}`);
                renderSuiteDropdown(suitesCache[project], suiteSelect);
                return;
            }

            // Show loading state
            suiteSelect.innerHTML = '<option value="">â³ Loading suites...</option>';
            suiteSelect.disabled = true;
            if (fetchBtn) fetchBtn.disabled = true;

            try {
                const allSuiteNames = new Set();
                
                // Get first page to know total pages
                const firstResponse = await fetch(
                    `${CONFIG.RP_HOST}/api/v1/${project}/launch?page.size=300&page.page=1`
                );
                const firstPage = await firstResponse.json();
                
                if (firstPage.errorCode) {
                    throw new Error(firstPage.message || 'API Error');
                }
                
                const totalPages = Math.min(firstPage.page.totalPages, 10); // Max 10 pages
                firstPage.content.forEach(l => allSuiteNames.add(l.name));
                console.log(`Project ${project}: ${firstPage.page.totalElements} launches, ${totalPages} pages to fetch`);

                // Fetch remaining pages in parallel batches of 3
                if (totalPages > 1) {
                    for (let page = 2; page <= totalPages; page += 3) {
                        const batch = [];
                        for (let p = page; p < page + 3 && p <= totalPages; p++) {
                            batch.push(
                                fetch(`${CONFIG.RP_HOST}/api/v1/${project}/launch?page.size=300&page.page=${p}`)
                                    .then(r => r.json())
                            );
                        }
                        const results = await Promise.all(batch);
                        results.forEach(data => {
                            if (data.content) {
                                data.content.forEach(l => allSuiteNames.add(l.name));
                            }
                        });
                    }
                }

                const suiteNames = [...allSuiteNames].sort();
                console.log(`Loaded ${suiteNames.length} unique suites for ${project}`);
                
                // Cache the results
                suitesCache[project] = suiteNames;
                
                renderSuiteDropdown(suiteNames, suiteSelect);
                
            } catch (e) {
                console.error(`Error loading suites for ${project}:`, e);
                suiteSelect.innerHTML = `<option value="">Error: ${e.message}</option>`;
            } finally {
                suiteSelect.disabled = false;
                if (fetchBtn) fetchBtn.disabled = true; // Keep disabled until suite selected
            }

            // Setup event listeners (only once)
            if (!suiteSelect.hasAttribute('data-listeners-added')) {
                suiteSelect.setAttribute('data-listeners-added', 'true');
                
                suiteSelect.addEventListener('change', () => {
                    const btn = document.getElementById('fetchReportBtn');
                    if (btn) btn.disabled = !suiteSelect.value;
                    if (suiteSelect.value) fetchReport();
                });

                if (fetchBtn) {
                    fetchBtn.addEventListener('click', fetchReport);
                }

                // Date filter listeners
                const dateFilter = document.getElementById('suiteReportDateFilter');
                const clearDateBtn = document.getElementById('clearSuiteDateFilter');
                
                if (dateFilter) {
                    dateFilter.addEventListener('change', () => {
                        if (suiteSelect.value) {
                            fetchReport();
                        }
                    });
                }

                if (clearDateBtn) {
                    clearDateBtn.addEventListener('click', () => {
                        if (dateFilter) {
                            dateFilter.value = '';
                            // Clear cached list
                            cachedReportsList = null;
                            cachedDateFilter = null;
                            cachedSuiteName = null;
                            // Hide reports list and back button
                            document.getElementById('reportsListContainer').classList.add('hidden');
                            document.getElementById('backToReportsList').classList.add('hidden');
                            if (suiteSelect.value) {
                                fetchReport();
                            }
                        }
                    });
                }

                // Back to reports list button
                const backToListBtn = document.getElementById('backToReportsList');
                if (backToListBtn) {
                    backToListBtn.addEventListener('click', goBackToReportsList);
                }
            }
        }

        function renderSuiteDropdown(suiteNames, suiteSelect) {
            // Group suites
            const grouped = {};
            suiteNames.forEach(name => {
                const cat = name.includes('UI_AUTOMATION') ? 'UI Automation' : 
                           name.startsWith('PLATFORM_API_') ? 'API Automation' : 
                           name.startsWith('IA_API_') ? 'IA API' : 'Other';
                if (!grouped[cat]) grouped[cat] = [];
                grouped[cat].push(name);
            });

            let html = '<option value="">-- Select a Test Suite --</option>';
            // Sort categories to put UI Automation first
            const sortedCats = Object.keys(grouped).sort((a, b) => {
                if (a === 'UI Automation') return -1;
                if (b === 'UI Automation') return 1;
                return a.localeCompare(b);
            });
            
            sortedCats.forEach(cat => {
                const count = grouped[cat].length;
                html += `<optgroup label="${cat} (${count})">`;
                grouped[cat].forEach(name => {
                    const short = name
                        .replace('PLATFORM_UI_AUTOMATION_', '')
                        .replace('PLATFORM_API_', '')
                        .replace('IA_API_', '')
                        .replace(/_/g, ' ');
                    html += `<option value="${name}">${short}</option>`;
                });
                html += '</optgroup>';
            });
            suiteSelect.innerHTML = html;
        }

        async function fetchReport() {
            const suiteName = document.getElementById('suiteSelect').value;
            const dateFilter = document.getElementById('suiteReportDateFilter').value;
            if (!suiteName) return;

            document.getElementById('mainEmptyState').classList.add('hidden');
            document.getElementById('mainReportCard').classList.add('hidden');
            document.getElementById('reportsListContainer').classList.add('hidden');
            document.getElementById('mainLoadingState').classList.remove('hidden');

            try {
                // Build the API URL with optional date filter
                let apiUrl = `${CONFIG.RP_HOST}/api/v1/${CONFIG.RP_PROJECT}/launch?filter.eq.name=${encodeURIComponent(suiteName)}&page.sort=startTime,desc`;
                
                if (dateFilter) {
                    // Filter by date: get all reports from that day using gte and lte filters
                    const startOfDay = new Date(dateFilter + 'T00:00:00');
                    const endOfDay = new Date(dateFilter + 'T23:59:59.999');
                    
                    apiUrl += `&filter.gte.startTime=${startOfDay.getTime()}&filter.lte.startTime=${endOfDay.getTime()}&page.size=50`;
                } else {
                    // No date filter: get latest report only
                    apiUrl += '&page.size=1';
                }

                const response = await fetch(apiUrl);
                const data = await response.json();

                if (!data.content || !data.content.length) {
                    document.getElementById('mainLoadingState').classList.add('hidden');
                    if (dateFilter) {
                        // Show no results message for date filter
                        const reportsGrid = document.getElementById('reportsGrid');
                        reportsGrid.innerHTML = `
                            <div class="no-results-message" style="grid-column: 1 / -1;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ“­</div>
                                <h4>No Reports Found</h4>
                                <p>No test runs found for "${formatSuiteName(suiteName)}" on ${formatDateDisplay(dateFilter)}</p>
                            </div>
                        `;
                        document.getElementById('reportsListTitle').textContent = `Reports for ${formatDateDisplay(dateFilter)}`;
                        document.getElementById('reportsListContainer').classList.remove('hidden');
                    } else {
                    document.getElementById('mainEmptyState').classList.remove('hidden');
                    }
                    return;
                }

                // If date filter is active, show multiple reports
                if (dateFilter && data.content.length > 0) {
                    renderMultipleReports(data.content, dateFilter, suiteName);
                } else {
                    // Show single report (latest) - clear cache since not from list
                    cachedReportsList = null;
                    cachedDateFilter = null;
                    cachedSuiteName = null;
                    document.getElementById('backToReportsList').classList.add('hidden');
                    renderSingleReport(data.content[0]);
                }

            } catch (e) {
                console.error('Error fetching report:', e);
                document.getElementById('mainLoadingState').classList.add('hidden');
                document.getElementById('mainEmptyState').classList.remove('hidden');
            }
        }

        function renderMultipleReports(launches, dateFilter, suiteName) {
            const reportsGrid = document.getElementById('reportsGrid');
            
            // Cache the list for back navigation
            cachedReportsList = launches;
            cachedDateFilter = dateFilter;
            cachedSuiteName = suiteName;
            
            // Hide back button when showing list
            document.getElementById('backToReportsList').classList.add('hidden');
            
            document.getElementById('reportsListTitle').textContent = 
                `${launches.length} Report${launches.length > 1 ? 's' : ''} for ${formatDateDisplay(dateFilter)}`;
            
            reportsGrid.innerHTML = launches.map(launch => {
                const stats = launch.statistics?.executions || {};
                const time = new Date(launch.startTime).toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: true 
                });
                const duration = Math.round((launch.approximateDuration || 0) / 60);
                
                return `
                    <div class="report-card-mini ${launch.status.toLowerCase()}" 
                         data-launch-id="${launch.id}" 
                         onclick="selectReport(${launch.id}, '${suiteName.replace(/'/g, "\\'")}')">
                        <div class="report-card-mini-header">
                            <div class="report-card-mini-title">
                                <span>#${launch.number}</span>
                            </div>
                            <div class="report-card-mini-status ${launch.status.toLowerCase()}">${launch.status}</div>
                        </div>
                        <div class="report-card-mini-stats">
                            <span class="passed">âœ“ ${stats.passed || 0}</span>
                            <span class="failed">âœ— ${stats.failed || 0}</span>
                            <span style="color: var(--text-secondary)">Total: ${stats.total || 0}</span>
                        </div>
                        <div class="report-card-mini-meta">
                            <span>ðŸ• ${time}</span>
                            <span>â±ï¸ ${duration}m</span>
                            <span>ðŸ‘¤ ${launch.owner || 'Unknown'}</span>
                            <button class="copy-link-btn"
                                    onclick="copyReportLink('https://reportportal.qa.staging.integrator.io/ui/#${CONFIG.RP_PROJECT}/launches/all/${launch.id}', event)"
                                    title="Copy Report Link">ðŸ“‹</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('mainLoadingState').classList.add('hidden');
            document.getElementById('reportsListContainer').classList.remove('hidden');
        }

        let cachedReportsList = null;
        let cachedDateFilter = null;
        let cachedSuiteName = null;

        async function selectReport(launchId, suiteName) {
            document.getElementById('reportsListContainer').classList.add('hidden');
            document.getElementById('mainLoadingState').classList.remove('hidden');
            
            try {
                const response = await fetch(
                    `${CONFIG.RP_HOST}/api/v1/${CONFIG.RP_PROJECT}/launch/${launchId}`
                );
                const launch = await response.json();
                
                // Show back button if we came from a list
                const backBtn = document.getElementById('backToReportsList');
                if (backBtn && cachedReportsList) {
                    backBtn.classList.remove('hidden');
                }
                
                renderSingleReport(launch);
            } catch (e) {
                console.error('Error fetching report details:', e);
                document.getElementById('mainLoadingState').classList.add('hidden');
                document.getElementById('reportsListContainer').classList.remove('hidden');
            }
        }

        function goBackToReportsList() {
            if (cachedReportsList && cachedDateFilter && cachedSuiteName) {
                document.getElementById('mainReportCard').classList.add('hidden');
                document.getElementById('backToReportsList').classList.add('hidden');
                renderMultipleReports(cachedReportsList, cachedDateFilter, cachedSuiteName);
            }
        }

        async function renderSingleReport(launch) {
                const stats = launch.statistics?.executions || {};

                document.getElementById('reportSuiteName').textContent = launch.name;
                document.getElementById('reportStatus').textContent = launch.status;
                document.getElementById('reportStatus').className = `status-badge ${launch.status.toLowerCase()}`;
                document.getElementById('reportTotal').textContent = stats.total || 0;
                document.getElementById('reportPassed').textContent = stats.passed || 0;
                document.getElementById('reportFailed').textContent = stats.failed || 0;
            document.getElementById('reportDuration').textContent = Math.round((launch.approximateDuration || 0) / 60) + 'm';
                document.getElementById('reportLaunchId').textContent = launch.id;
                document.getElementById('reportRunNumber').textContent = '#' + launch.number;
                document.getElementById('reportBuildDate').textContent = launch.attributes?.find(a => a.key === 'Build')?.value || 'N/A';
                document.getElementById('reportOwner').textContent = launch.owner || 'N/A';
                document.getElementById('reportPlatform').textContent = launch.attributes?.find(a => a.key === 'Platform')?.value || 'N/A';
                document.getElementById('reportLink').href = `${CONFIG.RP_DIRECT}/ui/#${CONFIG.RP_PROJECT}/launches/all/${launch.id}`;

                // Failed tests
                if (stats.failed > 0) {
                    const failedResponse = await fetch(
                        `${CONFIG.RP_HOST}/api/v1/${CONFIG.RP_PROJECT}/item?filter.eq.launchId=${launch.id}&filter.eq.status=FAILED&page.size=20`
                    );
                    const failedData = await failedResponse.json();
                    const failedTests = failedData.content.filter(i => i.type === 'STEP');

                    document.getElementById('reportFailedList').innerHTML = failedTests.map((test, i) => `
                        <div class="failed-test-item">
                            <div class="failed-test-num">${i + 1}</div>
                            <div class="failed-test-name">${test.name}</div>
                        </div>
                    `).join('');
                    document.getElementById('reportFailedPanel').classList.remove('hidden');
                } else {
                    document.getElementById('reportFailedPanel').classList.add('hidden');
                }

                document.getElementById('mainLoadingState').classList.add('hidden');
                document.getElementById('mainReportCard').classList.remove('hidden');
        }

        function formatDateDisplay(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                weekday: 'short', 
                month: 'short', 
                day: 'numeric', 
                year: 'numeric' 
            });
        }

        // ==================== HELPERS ====================
        function getStatusIcon(status) {
            switch (status) {
                case 'PASSED': return 'âœ“';
                case 'FAILED': return 'âœ—';
                case 'IN_PROGRESS': return 'â—Œ';
                default: return '?';
            }
        }

        function formatSuiteName(name) {
            return name
                .replace('PLATFORM_UI_AUTOMATION_', '')
                .replace('PLATFORM_API_', '')
                .replace(/_AUTOMATION_TESTS_STAGING/g, '')
                .replace(/_/g, ' ')
                .substring(0, 40);
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = Math.floor((now - date) / 1000 / 60);
            if (diff < 1) return 'Just now';
            if (diff < 60) return `${diff}m ago`;
            if (diff < 1440) return `${Math.floor(diff / 60)}h ago`;
            return date.toLocaleDateString();
        }

        // ==================== REST API REPORTS ====================
        const REST_REPORTS_CONFIG = {
            baseUrl: window.location.origin + '/rest-reports',
            directUrl: 'https://reporting-portal.qa.staging.integrator.io'
        };
        
        // Helper function to build authenticated URL (fetches from server)
        async function buildAuthUrl(baseUrl, path = '') {
            try {
                const response = await fetch(`${window.location.origin}/api/generate-report-url?path=${encodeURIComponent(path)}`);
                const data = await response.json();
                if (data.error) {
                    console.error('Failed to generate auth URL:', data.error);
                    return null;
                }
                return data.url;
            } catch (error) {
                console.error('Error building auth URL:', error);
                return null;
            }
        }

        let currentPath = '/';
        let allDirectories = [];
        let isInEnvFolder = false;
        let navigationHistory = []; // Track navigation history for back button
        const ENV_FOLDERS = ['ci', 'qa', 'iaqa', 'staging', 'qaprod', 'cd'];

        async function initRestApiReports() {
            await fetchDirectory('/');
        }

        async function fetchDirectory(path) {
            const loading = document.getElementById('restapiLoading');
            const content = document.getElementById('restapiContent');
            const report = document.getElementById('restapiReport');
            const searchInput = document.getElementById('restapiSearch');
            const dateFilterContainer = document.getElementById('dateFilterContainer');
            const dateFilter = document.getElementById('dateFilter');

            // Clear search when navigating to a new folder
            if (searchInput) {
                searchInput.value = '';
            }

            // Clear date filter when navigating
            if (dateFilter) {
                dateFilter.value = '';
            }

            loading.classList.remove('hidden');
            content.classList.add('hidden');
            report.classList.add('hidden');

            currentPath = path;
            updateBreadcrumb(path);

            // Check if we're navigating INTO an environment folder
            const pathParts = path.split('/').filter(p => p);
            const lastFolder = pathParts[pathParts.length - 1]?.toLowerCase();
            isInEnvFolder = ENV_FOLDERS.includes(lastFolder);

            // Show/hide date filter based on whether we're in an env folder
            if (dateFilterContainer) {
                if (isInEnvFolder) {
                    dateFilterContainer.classList.remove('hidden');
                } else {
                    dateFilterContainer.classList.add('hidden');
                }
            }

            try {
                // Add cache-busting parameter to ensure fresh data
                const cacheBuster = `_t=${Date.now()}`;
                const response = await fetch(`${REST_REPORTS_CONFIG.baseUrl}/?path=/var/www/html${path === '/' ? '' : path}&${cacheBuster}`, {
                    cache: 'no-store'
                });
                const html = await response.text();
                
                // Check if this is a report page (has Test Report heading) rather than directory listing
                if (html.includes('<h1>Test Report</h1>') || html.includes('class="test-report"')) {
                    // This is a report, show it in the viewer
                    openReport(path);
                    return;
                }
                
                const directories = parseDirectoryListing(html, path);
                allDirectories = directories;
                
                // If directory is empty but path contains a timestamp pattern, try to open as report
                if (directories.length === 0 && /[A-Za-z]{3}_\d{2}_\d{4}/.test(path)) {
                    openReport(path);
                    return;
                }
                
                renderDirectories(directories);

                loading.classList.add('hidden');
                content.classList.remove('hidden');
            } catch (error) {
                console.error('Error fetching directory:', error);
                loading.classList.add('hidden');
                content.innerHTML = `<div class="empty-state"><p>Error loading directory: ${error.message}</p></div>`;
                content.classList.remove('hidden');
            }
        }

        function parseDirectoryListing(html, currentPath) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const rows = doc.querySelectorAll('table tr');
            const items = [];

            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 3) {
                    const typeCell = cells[0].textContent.trim();
                    const nameCell = cells[1].textContent.trim();
                    const linkCell = cells[2].querySelector('a');

                    if (nameCell && linkCell && !nameCell.includes('Back to Parent')) {
                        const isDirectory = typeCell.includes('Directory');
                        const href = linkCell.getAttribute('href');
                        
                        // Parse the path from the href
                        let itemPath = '';
                        if (href && href.includes('path=')) {
                            const pathMatch = href.match(/path=([^&]+)/);
                            if (pathMatch) {
                                itemPath = decodeURIComponent(pathMatch[1]).replace('/var/www/html', '');
                            }
                        }

                        items.push({
                            name: nameCell,
                            type: isDirectory ? 'directory' : 'file',
                            path: itemPath || `${currentPath === '/' ? '' : currentPath}/${nameCell}`,
                            timestamp: extractTimestamp(nameCell)
                        });
                    }
                }
            });

            // Sort: directories first, then by name
            return items.sort((a, b) => {
                if (a.type !== b.type) return a.type === 'directory' ? -1 : 1;
                return a.name.localeCompare(b.name);
            });
        }

        function extractTimestamp(name) {
            // Extract timestamp from names like "Nov_21_2025_03_45_rest_api_rest-api-automation"
            const match = name.match(/([A-Za-z]{3}_\d{2}_\d{4}_\d{2}_\d{2})/);
            if (match) {
                const parts = match[1].split('_');
                return `${parts[0]} ${parts[1]}, ${parts[2]} ${parts[3]}:${parts[4]}`;
            }
            return null;
        }

        function renderDirectories(items) {
            const grid = document.getElementById('restapiGrid');
            const searchValue = document.getElementById('restapiSearch').value.toLowerCase();
            const dateFilterValue = document.getElementById('dateFilter')?.value;

            // Apply search filter
            let filtered = searchValue 
                ? items.filter(item => item.name.toLowerCase().includes(searchValue))
                : items;

            // Apply date filter if we're in an env folder and a date is selected
            if (isInEnvFolder && dateFilterValue) {
                const selectedDate = new Date(dateFilterValue);
                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                const month = monthNames[selectedDate.getMonth()];
                const day = String(selectedDate.getDate()).padStart(2, '0');
                const year = selectedDate.getFullYear();
                
                // Create pattern to match: "Mon_DD_YYYY" format in folder names
                const datePattern = `${month}_${day}_${year}`;
                
                filtered = filtered.filter(item => {
                    return item.name.includes(datePattern);
                });
            }

            const hasFilters = searchValue || (isInEnvFolder && dateFilterValue);
            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1; padding: 3rem;">
                        <div class="empty-state-icon">ðŸ“</div>
                        <h3>No items found</h3>
                        <p>${hasFilters ? 'Try adjusting your filters' : 'This directory is empty'}</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filtered.map(item => `
                <div class="restapi-card ${item.type}" data-path="${item.path}" data-type="${item.type}">
                    <div class="restapi-card-icon">${item.type === 'directory' ? 'ðŸ“' : 'ðŸ“„'}</div>
                    <div class="restapi-card-info">
                        <div class="restapi-card-name" title="${item.name}">${formatProjectName(item.name)}</div>
                        <div class="restapi-card-meta">
                            ${item.timestamp || (item.type === 'directory' ? 'Directory' : 'Report')}
                        </div>
                    </div>
                </div>
            `).join('');

            // Add click handlers
            grid.querySelectorAll('.restapi-card').forEach(card => {
                card.addEventListener('click', () => {
                    const path = card.dataset.path;
                    const type = card.dataset.type;

                    if (type === 'directory') {
                        navigateToPath(path);
                    } else {
                        navigationHistory.push(currentPath); // Track before opening report
                        openReport(path);
                    }
                });
            });
        }

        function formatProjectName(name) {
            // Clean up common prefixes and make it more readable
            return name
                .replace(/^[A-Za-z]{3}_\d{2}_\d{4}_\d{2}_\d{2}_/, '')
                .replace(/_/g, ' ')
                .substring(0, 40) + (name.length > 40 ? '...' : '');
        }

        function updateBreadcrumb(path) {
            const breadcrumb = document.getElementById('breadcrumb');
            const backBtn = document.getElementById('restapiBackBtn');
            const parts = path.split('/').filter(p => p);

            // Show/hide back button based on whether we're at root
            if (backBtn) {
                if (parts.length > 0) {
                    backBtn.classList.remove('hidden');
                } else {
                    backBtn.classList.add('hidden');
                }
            }

            let html = `<span class="breadcrumb-item ${parts.length === 0 ? 'active' : ''}" data-path="/">ðŸ  Home</span>`;

            let currentPathBuild = '';
            parts.forEach((part, index) => {
                currentPathBuild += '/' + part;
                const isActive = index === parts.length - 1;
                html += `
                    <span class="breadcrumb-separator">â€º</span>
                    <span class="breadcrumb-item ${isActive ? 'active' : ''}" data-path="${currentPathBuild}">
                        ${formatProjectName(part)}
                    </span>
                `;
            });

            breadcrumb.innerHTML = html;

            // Add click handlers to breadcrumb items
            breadcrumb.querySelectorAll('.breadcrumb-item').forEach(item => {
                item.addEventListener('click', () => {
                    const targetPath = item.dataset.path;
                    navigateToPath(targetPath);
                });
            });
        }

        // Navigate to path with history tracking
        function navigateToPath(targetPath) {
            // Don't add to history if going to current path
            if (targetPath !== currentPath) {
                navigationHistory.push(currentPath);
            }
            fetchDirectory(targetPath);
        }

        // Go back one level in navigation history
        function navigateBack() {
            if (navigationHistory.length > 0) {
                const previousPath = navigationHistory.pop();
                fetchDirectory(previousPath);
            } else {
                // If no history, go to parent folder
                const parts = currentPath.split('/').filter(p => p);
                if (parts.length > 0) {
                    parts.pop();
                    const parentPath = parts.length > 0 ? '/' + parts.join('/') : '/';
                    fetchDirectory(parentPath);
                }
            }
        }

        async function openReport(path) {
            const loading = document.getElementById('restapiLoading');
            const content = document.getElementById('restapiContent');
            const report = document.getElementById('restapiReport');
            const frame = document.getElementById('reportFrame');
            const openLink = document.getElementById('openInNewTab');

            loading.classList.add('hidden');
            content.classList.add('hidden');

            // Check if this is a directory with index.html
            let reportUrl = `${REST_REPORTS_CONFIG.baseUrl}${path}`;
            if (!path.endsWith('.html')) {
                reportUrl = `${REST_REPORTS_CONFIG.baseUrl}${path}/index.html`;
            }

            // Direct URL for opening in new tab (with credentials)
            let reportPath = path;
            if (!path.endsWith('.html')) {
                reportPath = `${path}/index.html`;
            }
            const directUrl = await buildAuthUrl(REST_REPORTS_CONFIG.directUrl, reportPath);

            frame.src = reportUrl;
            openLink.href = directUrl || reportUrl;

            report.classList.remove('hidden');
        }

        function setupRestApiReportsListeners() {
            // Search input
            const searchInput = document.getElementById('restapiSearch');
            searchInput.addEventListener('input', () => {
                renderDirectories(allDirectories);
            });

            // Date filter input
            const dateFilter = document.getElementById('dateFilter');
            dateFilter.addEventListener('change', () => {
                renderDirectories(allDirectories);
            });

            // Clear date filter button
            const clearDateBtn = document.getElementById('clearDateFilter');
            clearDateBtn.addEventListener('click', () => {
                dateFilter.value = '';
                renderDirectories(allDirectories);
            });

            // Back to list button (for report viewer)
            document.getElementById('backToList').addEventListener('click', () => {
                const report = document.getElementById('restapiReport');
                const content = document.getElementById('restapiContent');
                const frame = document.getElementById('reportFrame');

                frame.src = '';
                report.classList.add('hidden');
                content.classList.remove('hidden');
            });

            // Back navigation button
            const restapiBackBtn = document.getElementById('restapiBackBtn');
            if (restapiBackBtn) {
                restapiBackBtn.addEventListener('click', navigateBack);
            }
        }

        // ==================== OWNER SUITES ====================
        // Owner-Suite mapping from CSV data
        const OWNER_SUITE_MAPPING = [
            { category: "agent-extension", suite: "Agents", owner: "Deepak" },
            { category: "api_execution", suite: "API_BUILDER_ADAPTOR", owner: "Sathwika" },
            { category: "api_execution", suite: "APIBUILDER_SFNS_E2E", owner: "Sathwika" },
            { category: "as2-adaptor", suite: "AS2Exports", owner: "Shakeer" },
            { category: "as2-adaptor", suite: "AS2Imports", owner: "Shakeer" },
            { category: "as2-adaptor", suite: "Standalone", owner: "Shakeer" },
            { category: "as2-adaptor", suite: "VAN", owner: "Shakeer" },
            { category: "authentication-service", suite: "Email_Signup_Validation2", owner: "Ashwatha" },
            { category: "authentication-service", suite: "Optimize_signup", owner: "Naveen" },
            { category: "authentication-service", suite: "University", owner: "Gautham" },
            { category: "authentication-service", suite: "MFA", owner: "Naveen" },
            { category: "authentication-service", suite: "Phase_0_SampleIntegration_Install", owner: "Gautham" },
            { category: "authentication-service", suite: "Email_Signup_Validation", owner: "Ashwatha" },
            { category: "authentication-service", suite: "OPTIMIZE_SIGNUP2", owner: "Ashwatha" },
            { category: "authentication-service", suite: "ACCOUNTLEVELACCESS_ADMIN", owner: "Deepak" },
            { category: "COMMON_SUITES", suite: "AshareId_Related_TCs", owner: "Prerana" },
            { category: "COMMON_SUITES", suite: "Dropbox", owner: "Swathi" },
            { category: "COMMON_SUITES", suite: "Splunk", owner: "Akhil" },
            { category: "COMMON_SUITES", suite: "AccountLevelAccess", owner: "Deepak" },
            { category: "COMMON_SUITES", suite: "DI_CORE", owner: "Geethika" },
            { category: "COMMON_SUITES", suite: "SignedURL", owner: "Prerana" },
            { category: "COMMON_SUITES", suite: "AccessData", owner: "Prerana" },
            { category: "COMMON_SUITES", suite: "FileAdaptor_GeneralServices3", owner: "Swathi" },
            { category: "COMMON_SUITES", suite: "On_Prem_DB", owner: "Bhanu" },
            { category: "COMMON_SUITES", suite: "AccountLevelAccess_Monitor_Tile", owner: "Deepak" },
            { category: "COMMON_SUITES", suite: "AccountLevelAccess_Monitor", owner: "Deepak" },
            { category: "COMMON_SUITES", suite: "AccountLevelAccess_Manage_or_Monitor", owner: "Deepak" },
            { category: "COMMON_SUITES", suite: "MultiEnvironment_2", owner: "Kaivalya" },
            { category: "COMMON_SUITES", suite: "Splunk_3", owner: "Akhil" },
            { category: "COMMON_SUITES", suite: "Box_Connector", owner: "Swathi" },
            { category: "COMMON_SUITES", suite: "Splunk_2", owner: "Akhil" },
            { category: "COMMON_SUITES", suite: "Csrf_Related_TCs", owner: "Suman" },
            { category: "COMMON_SUITES", suite: "On_Prem", owner: "Bhanu" },
            { category: "COMMON_SUITES", suite: "FileAdaptor_GeneralServices", owner: "Swathi" },
            { category: "COMMON_SUITES", suite: "Csrf_Related_TCs2", owner: "Gautham" },
            { category: "COMMON_SUITES", suite: "gptverse", owner: "Randeep" },
            { category: "data-warehouse-adaptor", suite: "Snowflake_BulkLoad3", owner: "Bhanu" },
            { category: "data-warehouse-adaptor", suite: "Data_warehouse_Adaptor", owner: "Bhanu" },
            { category: "data-warehouse-adaptor", suite: "Snowflake_BulkLoad", owner: "Bhanu" },
            { category: "data-warehouse-adaptor", suite: "Snowflake_BulkLoad2", owner: "Bhanu" },
            { category: "data-warehouse-adaptor", suite: "Snowflake_BulkLoad4", owner: "Bhanu" },
            { category: "EDI-SUITES", suite: "EDI_TPConnector", owner: "Shakeer" },
            { category: "EDI-SUITES", suite: "EDIGlobalParser_Generator", owner: "Shakeer" },
            { category: "EDI-SUITES", suite: "EDI_licenses", owner: "Shakeer" },
            { category: "EDI-SUITES", suite: "EDIProfiles", owner: "Shakeer" },
            { category: "EDI-SUITES", suite: "EDI", owner: "Shakeer" },
            { category: "EDI-SUITES", suite: "EDI2", owner: "Shakeer" },
            { category: "EDI-SUITES", suite: "EDIDashboard", owner: "Shakeer" },
            { category: "EDI-SUITES", suite: "EDIProfile_ILM", owner: "Shakeer" },
            { category: "endpoint-service", suite: "Mapper2.0_Suite1", owner: "Shiva" },
            { category: "endpoint-service", suite: "MYAPI_MS", owner: "Sowmya" },
            { category: "endpoint-service", suite: "Proxy", owner: "Sowmya" },
            { category: "endpoint-service", suite: "Oauth2MS", owner: "Sowmya" },
            { category: "endpoint-service", suite: "Transformation2.0_suite2", owner: "Shiva" },
            { category: "endpoint-service", suite: "Metadata", owner: "Bhanu" },
            { category: "endpoint-service", suite: "UI2API_MAPPER2.0", owner: "Shiva" },
            { category: "endpoint-service", suite: "ResourceAliases", owner: "Anitha" },
            { category: "endpoint-service", suite: "Mapper2.0_Suite3", owner: "Shiva" },
            { category: "endpoint-service", suite: "Mapper2.0_Suite4", owner: "Shiva" },
            { category: "endpoint-service", suite: "Mapper2.0_Suite2", owner: "Shiva" },
            { category: "endpoint-service", suite: "Mapper_Preview", owner: "Shiva" },
            { category: "endpoint-service", suite: "Transformation2.0_suite1", owner: "Shiva" },
            { category: "endpoint-service", suite: "AFE", owner: "Shiva" },
            { category: "endpoint-service", suite: "ResponseHeaderToken", owner: "Sowmya" },
            { category: "endpoint-service", suite: "NETSUITE4_EP", owner: "Anitha" },
            { category: "endpoint-service", suite: "STANDALONE", owner: "Sowmya" },
            { category: "error-notifications", suite: "Notification_Emails_3", owner: "Naveen" },
            { category: "error-notifications", suite: "Notification_Emails_4", owner: "Naveen" },
            { category: "error-notifications", suite: "Notification_Emails_2", owner: "Naveen" },
            { category: "error-notifications", suite: "Notification_Emails", owner: "Naveen" },
            { category: "error-notifications", suite: "Notification_Emails_6", owner: "Naveen" },
            { category: "error-notifications", suite: "Notification_Emails_5", owner: "Naveen" },
            { category: "file-adaptor", suite: "S3_Adaptor2", owner: "Swathi" },
            { category: "file-adaptor", suite: "S3_Adaptor", owner: "Swathi" },
            { category: "file-adaptor", suite: "Dataloader", owner: "Swathi" },
            { category: "file-adaptor", suite: "HTTP_OAUTH_1.0", owner: "Swathi" },
            { category: "file-adaptor", suite: "LINEARCOMPLEX_E2E_FLOWS", owner: "Swathi" },
            { category: "file-adaptor", suite: "SPLUNK_3", owner: "Swathi" },
            { category: "file-adaptor", suite: "END_TO_END_FLOWS", owner: "Swathi" },
            { category: "file-adaptor", suite: "CONNECTIONS", owner: "Swathi" },
            { category: "file-service", suite: "FileServices", owner: "Swathi" },
            { category: "flow-management", suite: "jobs_schema", owner: "Gaurav" },
            { category: "flow-management", suite: "ETAG", owner: "Gautham" },
            { category: "flow-management", suite: "FlowDebugger", owner: "Deepak" },
            { category: "flow-management", suite: "Dashboard", owner: "Deepak" },
            { category: "flow-management", suite: "EM2.0_2", owner: "Akhil" },
            { category: "flow-management", suite: "Shopify", owner: "Naveen" },
            { category: "flow-management", suite: "FlowSchedule", owner: "Suman" },
            { category: "flow-management", suite: "Assign_Errors_To_Users", owner: "Kaivalya" },
            { category: "flow-management", suite: "EM2.0", owner: "Akhil" },
            { category: "flow-management", suite: "Assign_Errors_To_Users_2", owner: "Kaivalya" },
            { category: "flow-management", suite: "FlowStepDebugLogs", owner: "Geethika" },
            { category: "flow-management", suite: "SPLUNK_3", owner: "Geethika" },
            { category: "flow-management", suite: "ACCESSDATA", owner: "Prerana" },
            { category: "http-adaptor", suite: "Async_Helper", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP_Azure", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "JWTSchemavalidations", owner: "Shafeek" },
            { category: "http-adaptor", suite: "HTTP_OAuth_1.0", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP4", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "HTTP_Connection", owner: "Shafeek" },
            { category: "http-adaptor", suite: "Jwt_Standalone", owner: "Shafeek" },
            { category: "http-adaptor", suite: "HTTP_URL_Download", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "HTTP_Adaptor_Global_iClient_support", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "GDRIVE2", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "HTTP3", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "AmazonSP", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "HTTP2", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "HTTP_AXIOS_NEGATIVE", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "HTTP_AMAZON_PAY", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP_OAuth2.0_Redesign", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "SupportContent_BE", owner: "Shafeek" },
            { category: "http-adaptor", suite: "HTTP_Async_Helper", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP_MS", owner: "Shafeek" },
            { category: "http-adaptor", suite: "HTTP_fileSize", owner: "Shafeek" },
            { category: "http-adaptor", suite: "HTTP_Blob_Export", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "RestImport", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP_Blob_Import", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP5", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP6", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "HTTP7", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "END_TO_END_FLOWS", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "LINEARCOMPLEX_E2E_FLOWS", owner: "Sujatha Kutcharlapati" },
            { category: "http-adaptor", suite: "CONNECTIONS", owner: "Shafeek" },
            { category: "http-adaptor", suite: "FileAdaptor_GeneralServices", owner: "Shafeek" },
            { category: "http-adaptor", suite: "STANDALONE", owner: "Shafeek" },
            { category: "http-adaptor", suite: "HUGE_RECORDS", owner: "Nishitha Maddati" },
            { category: "http-adaptor", suite: "SPLUNK_3", owner: "Sujatha Kutcharlapati" },
            { category: "jdbc-bridge", suite: "NSAW_BULKLOAD", owner: "Bhanu" },
            { category: "jdbc-bridge", suite: "ActiveDirectory", owner: "Bhanu" },
            { category: "jdbc-bridge", suite: "OracleADW", owner: "Bhanu" },
            { category: "jdbc-bridge", suite: "NetSuite_JDBC", owner: "Bhanu" },
            { category: "jdbc-bridge", suite: "Databricks", owner: "Bhanu" },
            { category: "jdbc-bridge", suite: "WORKDAY", owner: "Bhanu" },
            { category: "js-runtime", suite: "Scripts", owner: "Sowmya" },
            { category: "js-runtime", suite: "JSRT_Invoke_route_Suite1", owner: "Sowmya" },
            { category: "js-runtime", suite: "JSRT_Invoke_route_Suite2", owner: "Sowmya" },
            { category: "js-runtime", suite: "JSRT_MyApi_Flows_Run", owner: "Sowmya" },
            { category: "js-runtime", suite: "LINEARCOMPLEX_E2E_FLOWS", owner: "Sowmya" },
            { category: "js-runtime", suite: "STANDALONE", owner: "Sowmya" },
            { category: "netsuite-distributed-adaptor", suite: "NetSuite3", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NS_SS2_Suite1", owner: "Nithin" },
            { category: "netsuite-distributed-adaptor", suite: "NetSuite4", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NetSuite5", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NETSUITEONCE", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NETSUITE_DISTRIBUTED", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NetSuite_FlowDebugger_Lookups", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NetSuite", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NS_SS2_Suite4", owner: "Nithin" },
            { category: "netsuite-distributed-adaptor", suite: "NS_SS2_Suite3", owner: "Nithin" },
            { category: "netsuite-distributed-adaptor", suite: "Netsuite_RestwebServices", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NS_SS2_Suite2", owner: "Nithin" },
            { category: "netsuite-distributed-adaptor", suite: "NS_SS2_Suite5", owner: "Nithin" },
            { category: "netsuite-distributed-adaptor", suite: "NetSuite_FlowDebugger", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "SuiteApp", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NETSUITE_DISTRIBUTED1", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "SuiteApp2", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NetSuite2", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "NS_SS2_Suite6", owner: "Nithin" },
            { category: "netsuite-distributed-adaptor", suite: "STANDALONE", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "SPLUNK_3", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "END_TO_END_FLOWS", owner: "Anitha" },
            { category: "netsuite-distributed-adaptor", suite: "CONNECTIONS", owner: "Anitha" },
            { category: "netsuite-webservices-adaptor", suite: "NetSuite_FileProviders", owner: "Swathi" },
            { category: "netsuite-webservices-adaptor", suite: "NetSuite_FileProviders2", owner: "Swathi" },
            { category: "netsuite-webservices-adaptor", suite: "NETSUITE_WEBSERVICES", owner: "Anitha" },
            { category: "netsuite-webservices-adaptor", suite: "STANDALONE", owner: "Anitha" },
            { category: "nosql-db-adaptor", suite: "MongoDB", owner: "Bhanu" },
            { category: "nosql-db-adaptor", suite: "DynamoDB", owner: "Bhanu" },
            { category: "performance", suite: "SF_BULK_LOAD", owner: "Sathwika" },
            { category: "rdbms-adaptor", suite: "PostgreSQL", owner: "Bhanu" },
            { category: "rdbms-adaptor", suite: "MariaDB", owner: "Bhanu" },
            { category: "rdbms-adaptor", suite: "AzureSynapse", owner: "Bhanu" },
            { category: "rdbms-adaptor", suite: "MsSQL", owner: "Bhanu" },
            { category: "rdbms-adaptor", suite: "MySql", owner: "Bhanu" },
            { category: "rdbms-adaptor", suite: "ON_PREM", owner: "Bhanu" },
            { category: "rdbms-adaptor", suite: "ON_PREM_DB", owner: "Bhanu" },
            { category: "resource-management", suite: "Licenses", owner: "Suman" },
            { category: "resource-management", suite: "FlowGrouping", owner: "Geethika" },
            { category: "resource-management", suite: "InviteUser", owner: "Gautham" },
            { category: "resource-management", suite: "Transfer_OwnerShip", owner: "Geethika" },
            { category: "resource-management", suite: "IOAccount_NO_SBAccess", owner: "Geethika" },
            { category: "resource-management", suite: "VAN_Connector", owner: "Naveen" },
            { category: "resource-management", suite: "Transfer_Ownership_Email", owner: "Akhil" },
            { category: "resource-management", suite: "Change_In_No_Of_Endpoints", owner: "Gaurav" },
            { category: "resource-management", suite: "API_Management", owner: "Gaurav" },
            { category: "resource-management", suite: "Server", owner: "Suman" },
            { category: "resource-management", suite: "API_Builder", owner: "Gaurav" },
            { category: "resource-management", suite: "APIM_MULTI_ENV_TEST", owner: "Gaurav" },
            { category: "resource-management", suite: "CAM_IA", owner: "Naveen" },
            { category: "resource-management", suite: "licenses_DisableOverage", owner: "Prerana" },
            { category: "resource-management", suite: "Selective_Fetching", owner: "Naveen" },
            { category: "resource-management", suite: "Platform_To_Endpoint_License_Conversion", owner: "Kaivalya" },
            { category: "resource-management", suite: "APIMADMIN", owner: "Gaurav" },
            { category: "resource-management", suite: "Usability", owner: "Gautham" },
            { category: "resource-management", suite: "OpenApiSpec", owner: "Prerana" },
            { category: "resource-management", suite: "ResourcePagination2", owner: "Gautham" },
            { category: "resource-management", suite: "SSO_Clients", owner: "Prerana" },
            { category: "resource-management", suite: "EndpointLicensing", owner: "Suman" },
            { category: "resource-management", suite: "Stacks", owner: "Akhil" },
            { category: "resource-management", suite: "ResourcePagination", owner: "Gautham" },
            { category: "resource-management", suite: "Allow_Users_To_Download_All_Logs", owner: "Deepak" },
            { category: "resource-management", suite: "Cloning", owner: "Gaurav" },
            { category: "resource-management", suite: "Templates", owner: "Geethika" },
            { category: "resource-management", suite: "FEATURED_TEMPLATES", owner: "Prerana" },
            { category: "resource-management", suite: "PlatformLicenses", owner: "Suman" },
            { category: "resource-management", suite: "RMS_Bugs", owner: "Gautham" },
            { category: "resource-management", suite: "GOVERNANCE", owner: "Kaivalya" },
            { category: "resource-management", suite: "MULTIENVIRONMENT_1", owner: "Kaivalya" },
            { category: "resource-management", suite: "MULTIENVIRONMENT_3", owner: "Kaivalya" },
            { category: "resource-management-PFExtension", suite: "IAF2.0", owner: "Swathi" },
            { category: "resource-management-PFExtension", suite: "HTTP2.0", owner: "Shafeek" },
            { category: "resource-management-PFExtension", suite: "IAF2.0_1", owner: "Khaisar" },
            { category: "resource-management-PFExtension", suite: "PKCE_BE", owner: "Shafeek" },
            { category: "resource-management-PFExtension", suite: "UI2API_IAF", owner: "Khaisar" },
            { category: "resource-management-PFExtension", suite: "IAF2.0_2", owner: "Swathi" },
            { category: "resource-management-PFExtension", suite: "IAF2.0_3", owner: "Swathi" },
            { category: "resource-management-Platform", suite: "ILM_MULTIENV", owner: "Sathwika" },
            { category: "resource-management-Platform", suite: "ResourceAliases", owner: "Anitha" },
            { category: "resource-management-Platform", suite: "ILM", owner: "Anitha" },
            { category: "salesforce-adaptor", suite: "SF_BULKAPI2", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "Salesforce_MS_Regression3", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "SF_MS", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "Salesforce", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "Salesforce_MS_Regression", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "Salesforce_MS_Regression2", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "SF_BULKAPI", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "SF_BULKAPI5", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "SF_bulk", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "SF_BULKAPI3", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "Salesforce_MS_Regression1", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "STANDALONE_SF", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "SF_BULKAPI4", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "STANDALONE", owner: "Sathwika" },
            { category: "salesforce-adaptor", suite: "Connections", owner: "Sathwika" },
            { category: "webhooks", suite: "webhook1", owner: "Gautham" },
            { category: "webhooks", suite: "Webhook", owner: "Gautham" },
            { category: "webhooks", suite: "webhook2", owner: "Gautham" },
            { category: "webhooks", suite: "HUGE_RECORDS", owner: "Gautham" },
            { category: "webhooks", suite: "STANDALONE", owner: "Gautham" },
            { category: "worker", suite: "Flowbranching_router", owner: "Kaivalya" },
            { category: "worker", suite: "FlowBranching_E2E_Flows", owner: "Kaivalya" },
            { category: "worker", suite: "FlowBranching_Stability_Test_Cases", owner: "Kaivalya" },
            { category: "worker", suite: "Flowbranching_router2", owner: "Kaivalya" },
            { category: "lookup-cache", suite: "lookupcache1", owner: "Malla" },
            { category: "lookup-cache", suite: "lookupcache2", owner: "Malla" },
            { category: "lookup-cache", suite: "lookupcache_ilm", owner: "Malla" },
            { category: "lookup-cache", suite: "lookupcache_multienv", owner: "Malla" },
            { category: "lookup-cache", suite: "LOOKUPCACHE", owner: "Malla" },
            { category: "lookup-cache", suite: "LOOKUPCACHE_1GB", owner: "Malla" },
            { category: "FTP-BRIDGE-MS", suite: "FTP3", owner: "Shafeek" },
            { category: "FTP-BRIDGE-MS", suite: "FTP2", owner: "Shafeek" },
            { category: "FTP-BRIDGE-MS", suite: "FTP", owner: "Shafeek" },
            { category: "Resource-management", suite: "email_rms", owner: "Gautham" },
            { category: "Enterprise-logging", suite: "Enterprise_Logging", owner: "" }
        ];
        // UI Suite Owner Mapping from CSV data
        const UI_OWNER_SUITE_MAPPING = [
            // Aurora Team
            { team: "Aurora", suite: "MFA", owner: "Manish" },
            { team: "Aurora", suite: "FLOWGROUPING_IAF", owner: "Manish" },
            { team: "Aurora", suite: "email_suite", owner: "Manish" },
            { team: "Aurora", suite: "EMAIL_NOTIFICATION", owner: "Manish" },
            { team: "Aurora", suite: "email_validation", owner: "Manish" },
            { team: "Aurora", suite: "ftp_standalone_suite", owner: "Manish" },
            { team: "Aurora", suite: "ILM_INTEGRATION2", owner: "Manish" },
            { team: "Aurora", suite: "APIMMULTIENV", owner: "Manish" },
            { team: "Aurora", suite: "DI", owner: "Manish" },
            // Chloris Team
            { team: "Chloris", suite: "MFA2", owner: "Revathi" },
            { team: "Chloris", suite: "integration_apps", owner: "Revathi" },
            { team: "Chloris", suite: "account_switching", owner: "Revathi" },
            { team: "Chloris", suite: "MFA_ADMIN", owner: "Revathi" },
            { team: "Chloris", suite: "create_flows2", owner: "Revathi" },
            { team: "Chloris", suite: "MAY_PHOENIX", owner: "Revathi" },
            { team: "Chloris", suite: "afe", owner: "Revathi" },
            { team: "Chloris", suite: "phoenix_phase0", owner: "Revathi" },
            { team: "Chloris", suite: "api_builder", owner: "Revathi" },
            { team: "Chloris", suite: "Api_Suite1", owner: "Revathi" },
            { team: "Chloris", suite: "custom_suite", owner: "Revathi" },
            { team: "Chloris", suite: "APIM", owner: "Revathi" },
            { team: "Chloris", suite: "REST_HTTP", owner: "Revathi" },
            { team: "Chloris", suite: "simple_view", owner: "Revathi" },
            { team: "Chloris", suite: "Manage_few_suite", owner: "Revathi" },
            // Helios Team
            { team: "Helios", suite: "admin_suite", owner: "Shriti" },
            { team: "Helios", suite: "manage_suite", owner: "Shriti" },
            { team: "Helios", suite: "Databases", owner: "Shriti" },
            { team: "Helios", suite: "ILM_INTEGRATION", owner: "Shriti" },
            { team: "Helios", suite: "FlowDebugger", owner: "Shriti" },
            { team: "Helios", suite: "NSTHIRDPARTY", owner: "Shriti" },
            { team: "Helios", suite: "user_notify", owner: "Phani" },
            { team: "Helios", suite: "assignErrors", owner: "Phani" },
            { team: "Helios", suite: "monitor_suite", owner: "Phani" },
            { team: "Helios", suite: "create_flows_suite1_user", owner: "Phani" },
            { team: "Helios", suite: "general", owner: "Phani" },
            { team: "Helios", suite: "uiux_suite03", owner: "Phani" },
            { team: "Helios", suite: "connections", owner: "Phani" },
            { team: "Helios", suite: "edi_suite", owner: "Phani" },
            { team: "Helios", suite: "flowbranching01", owner: "Phani" },
            { team: "Helios", suite: "edit_flows", owner: "Phani" },
            // Eirene Team
            { team: "Eirene", suite: "FlowBuilder04", owner: "Mahesh" },
            { team: "Eirene", suite: "uiux_suite02", owner: "Mahesh" },
            { team: "Eirene", suite: "httpConnector2.0", owner: "Mahesh" },
            { team: "Eirene", suite: "standalone1", owner: "Mahesh" },
            { team: "Eirene", suite: "standalone7", owner: "Mahesh" },
            { team: "Eirene", suite: "FlowBuilder", owner: "Mahesh" },
            { team: "Eirene", suite: "standalone6", owner: "Mahesh" },
            // Hercules Team
            { team: "Hercules", suite: "e2e_flows", owner: "Subarna" },
            { team: "Hercules", suite: "NETSUITE_SS2.0", owner: "Mahesh" },
            { team: "Hercules", suite: "CeligoAI", owner: "Subarna" },
            { team: "Hercules", suite: "mapper2.0", owner: "Subarna" },
            { team: "Hercules", suite: "standalone5", owner: "Subarna" },
            { team: "Hercules", suite: "mapper2.0_2", owner: "Subarna" },
            { team: "Hercules", suite: "em2_2", owner: "Phani" },
            { team: "Hercules", suite: "Template", owner: "Shriti" },
            { team: "Hercules", suite: "em2", owner: "Shriti" },
            { team: "Hercules", suite: "standalone4", owner: "Shriti" },
            { team: "Hercules", suite: "FlowEventReport", owner: "Vikram" },
            { team: "Hercules", suite: "userManagement", owner: "Subarna" },
            // Iris Team
            { team: "Iris", suite: "transferSBflow", owner: "Vikram" },
            { team: "Iris", suite: "HTTP2DOT0", owner: "Vikram" },
            { team: "Iris", suite: "signoutPage", owner: "Vikram" },
            { team: "Iris", suite: "pricing_model_suite", owner: "Vikram" },
            { team: "Iris", suite: "uiux_suite01", owner: "Vikram" },
            { team: "Iris", suite: "onprem", owner: "Vikram" },
            { team: "Iris", suite: "transfer", owner: "Vikram" },
            { team: "Iris", suite: "flowbranching", owner: "Vikram" },
            { team: "Iris", suite: "edit_flows_2", owner: "Vikram" },
            // Phoenix Team
            { team: "Phoenix", suite: "account", owner: "Sagna" },
            { team: "Phoenix", suite: "signinpage", owner: "Sagna" },
            { team: "Phoenix", suite: "js-runtime", owner: "Sagna" },
            { team: "Phoenix", suite: "edit_connections", owner: "Sagna" },
            { team: "Phoenix", suite: "new UI", owner: "Sagna" },
            { team: "Phoenix", suite: "flowbuilder01", owner: "Sagna" },
            { team: "Phoenix", suite: "flowbuilder02", owner: "Sagna" },
            { team: "Phoenix", suite: "flowbuilder03", owner: "Sagna" },
            { team: "Phoenix", suite: "standalone2", owner: "Sagna" },
            { team: "Phoenix", suite: "standalone3", owner: "Sagna" },
            { team: "Phoenix", suite: "support_access", owner: "Sagna" },
            { team: "Phoenix", suite: "Multipleenvs", owner: "Sagna" },
            { team: "Phoenix", suite: "Multipleenvsinvited", owner: "Sagna" },
        ];

        // UI Owners Tab Variables
        let uiOwnerTabInitialized = false;
        let selectedUiOwnerSuites = [];
        let uiOwnerSuiteResults = [];

        let ownerTabInitialized = false;
        let selectedOwnerSuites = [];
        let ownerSuiteResults = [];

        // Initialize Owner tab when first shown
        function initOwnerTab() {
            if (ownerTabInitialized) return;
            ownerTabInitialized = true;

            // Get unique owners and sort them
            const owners = [...new Set(OWNER_SUITE_MAPPING.map(m => m.owner).filter(o => o && o.trim()))].sort();
            
            // Helper function to count unique suites (case-insensitive) for an owner
            function getUniqueSuiteCount(owner) {
                const ownerSuites = OWNER_SUITE_MAPPING.filter(m => m.owner === owner);
                const uniqueNames = new Set(ownerSuites.map(m => m.suite.toLowerCase()));
                return uniqueNames.size;
            }
            
            const ownerSelect = document.getElementById('ownerSelect');
            ownerSelect.innerHTML = '<option value="">-- Select an API Owner --</option>' +
                owners.map(owner => {
                    const count = getUniqueSuiteCount(owner);
                    return `<option value="${owner}">${owner} (${count} suites)</option>`;
                }).join('');

            // Setup event listeners
            const fetchBtn = document.getElementById('fetchOwnerSuitesBtn');
            const dateFilter = document.getElementById('ownerDateFilter');
            const clearDateBtn = document.getElementById('clearOwnerDateFilter');
            const backBtn = document.getElementById('backToOwnerSuites');
            const envSelect = document.getElementById('ownerEnvSelect');

            ownerSelect.addEventListener('change', () => {
                fetchBtn.disabled = !ownerSelect.value;
                if (ownerSelect.value) {
                    fetchOwnerSuites();
                }
            });

            fetchBtn.addEventListener('click', fetchOwnerSuites);

            dateFilter.addEventListener('change', () => {
                if (ownerSelect.value) {
                    fetchOwnerSuites();
                }
            });

            clearDateBtn.addEventListener('click', () => {
                dateFilter.value = '';
                if (ownerSelect.value) {
                    fetchOwnerSuites();
                }
            });

            backBtn.addEventListener('click', () => {
                document.getElementById('ownerSuiteDetailCard').classList.add('hidden');
                document.getElementById('ownerSuitesContainer').classList.remove('hidden');
            });

            envSelect.addEventListener('change', () => {
                if (ownerSelect.value) {
                    fetchOwnerSuites();
                }
            });
        }

        async function fetchOwnerSuites() {
            const ownerSelect = document.getElementById('ownerSelect');
            const dateFilter = document.getElementById('ownerDateFilter').value;
            const envSelect = document.getElementById('ownerEnvSelect');
            const selectedOwner = ownerSelect.value;
            const selectedEnv = envSelect.value; // 'staging', 'qa', 'iaqa'

            if (!selectedOwner) return;

            // Show loading state
            document.getElementById('ownerEmptyState').classList.add('hidden');
            document.getElementById('ownerSuitesContainer').classList.add('hidden');
            document.getElementById('ownerSuiteDetailCard').classList.add('hidden');
            document.getElementById('ownerLoadingState').classList.remove('hidden');

            // Get suites for this owner from the CSV mapping
            // Deduplicate by suite name (case-insensitive) - keep the first occurrence if same suite appears in multiple categories
            const ownerSuitesRaw = OWNER_SUITE_MAPPING.filter(m => m.owner === selectedOwner);
            const seenSuiteNames = new Set();
            selectedOwnerSuites = ownerSuitesRaw.filter(m => {
                const normalizedName = m.suite.toLowerCase();
                if (seenSuiteNames.has(normalizedName)) {
                    return false; // Skip duplicate suite name (case-insensitive)
                }
                seenSuiteNames.add(normalizedName);
                return true;
            });
            
            console.log(`Fetching REST API reports for owner: ${selectedOwner}, env: ${selectedEnv}, date: ${dateFilter || 'any'}`);
            console.log(`Found ${selectedOwnerSuites.length} suites for owner`);

            try {
                // Fetch report folders for each suite from REST API Reports portal
                const results = [];
                const batchSize = 15; // Increased from 5 for faster parallel processing

                // Get all unique main folders (categories) for searching COMMON_SUITES
                const allMainFolders = [...new Set(OWNER_SUITE_MAPPING.map(m => m.category))];
                
                // Suites that need to search across all folders (not just their listed category)
                const SEARCH_ALL_FOLDERS_SUITES = [
                    'Phase_0_SampleIntegration_Install',  // Listed in authentication-service but exists in resource-management
                ];
                
                // OPTIMIZATION: Cache for folder listings to avoid duplicate fetches
                const folderCache = new Map();
                const dateFolderCache = new Map();
                
                // Helper function to fetch and cache env folder listing
                async function getCachedEnvFolder(category) {
                    const basePath = `/${category}/${selectedEnv}`;
                    const cacheKey = basePath;
                    
                    if (folderCache.has(cacheKey)) {
                        return folderCache.get(cacheKey);
                    }
                    
                    try {
                        const response = await fetch(`${REST_REPORTS_CONFIG.baseUrl}/?path=/var/www/html${basePath}`);
                        if (!response.ok) {
                            folderCache.set(cacheKey, null);
                            return null;
                        }
                        const html = await response.text();
                        const dateFolders = parseDateFolders(html, basePath, dateFilter);
                        folderCache.set(cacheKey, { basePath, dateFolders });
                        return { basePath, dateFolders };
                    } catch (e) {
                        folderCache.set(cacheKey, null);
                        return null;
                    }
                }
                
                // Helper function to fetch and cache date folder contents
                async function getCachedDateFolder(folderPath) {
                    if (dateFolderCache.has(folderPath)) {
                        return dateFolderCache.get(folderPath);
                    }
                    
                    try {
                        const response = await fetch(`${REST_REPORTS_CONFIG.baseUrl}/?path=/var/www/html${folderPath}`);
                        if (!response.ok) {
                            dateFolderCache.set(folderPath, null);
                            return null;
                        }
                        const html = await response.text();
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        const rows = doc.querySelectorAll('table tr');
                        const suites = [];
                        rows.forEach(row => {
                            const cells = row.querySelectorAll('td');
                            if (cells.length >= 2) {
                                const nameCell = cells[1]?.textContent?.trim();
                                if (nameCell && !nameCell.includes('Back to Parent')) {
                                    suites.push(nameCell);
                                }
                            }
                        });
                        dateFolderCache.set(folderPath, suites);
                        return suites;
                    } catch (e) {
                        dateFolderCache.set(folderPath, null);
                        return null;
                    }
                }
                
                // Helper function to fetch report statistics from Jest HTML report
                const statsCache = new Map();
                async function getReportStats(suitePath) {
                    if (statsCache.has(suitePath)) {
                        return statsCache.get(suitePath);
                    }
                    
                    try {
                        // Fetch the index.html report directly
                        const reportUrl = `${REST_REPORTS_CONFIG.baseUrl}${suitePath}/index.html`;
                        const response = await fetch(reportUrl);
                        if (!response.ok) {
                            statsCache.set(suitePath, null);
                            return null;
                        }
                        const html = await response.text();
                        
                        // Parse Jest HTML report format:
                        // <div id="test-summary"><div class="summary-total">Tests (49)</div>
                        // <div class="summary-passed">36 passed</div>
                        // <div class="summary-failed">13 failed</div>
                        // Look specifically in the test-summary section to avoid suite-summary
                        const testSummaryMatch = html.match(/id="test-summary"[^]*?<\/div>\s*<\/div>/i);
                        const testSummary = testSummaryMatch ? testSummaryMatch[0] : html;
                        
                        const totalMatch = testSummary.match(/summary-total[^>]*>Tests\s*\((\d+)\)/i);
                        const passedMatch = testSummary.match(/summary-passed[^>]*>(\d+)\s*passed/i);
                        const failedMatch = testSummary.match(/summary-failed[^>]*>(\d+)\s*failed/i);
                        
                        if (totalMatch || passedMatch || failedMatch) {
                            const stats = {
                                total: totalMatch ? parseInt(totalMatch[1]) : 0,
                                passed: passedMatch ? parseInt(passedMatch[1]) : 0,
                                failed: failedMatch ? parseInt(failedMatch[1]) : 0
                            };
                            // If total is 0, calculate from passed + failed
                            if (stats.total === 0) {
                                stats.total = stats.passed + stats.failed;
                            }
                            statsCache.set(suitePath, stats);
                            return stats;
                        }
                        
                        statsCache.set(suitePath, null);
                        return null;
                    } catch (e) {
                        console.log(`Failed to fetch stats for ${suitePath}:`, e.message);
                        statsCache.set(suitePath, null);
                        return null;
                    }
                }
                
                // OPTIMIZATION: Pre-fetch all unique category folders in parallel
                const uniqueCategories = [...new Set(selectedOwnerSuites.map(s => s.category))];
                const hasSearchAllSuites = selectedOwnerSuites.some(s => 
                    s.category.toUpperCase() === 'COMMON_SUITES' || SEARCH_ALL_FOLDERS_SUITES.includes(s.suite)
                );
                
                // Pre-fetch categories needed
                const categoriesToFetch = hasSearchAllSuites ? allMainFolders : uniqueCategories;
                console.log(`Pre-fetching ${categoriesToFetch.length} category folders...`);
                await Promise.all(categoriesToFetch.map(cat => getCachedEnvFolder(cat)));
                console.log(`Pre-fetch complete. Processing ${selectedOwnerSuites.length} suites...`);
                
                // Process all suites in parallel batches
                for (let i = 0; i < selectedOwnerSuites.length; i += batchSize) {
                    const batch = selectedOwnerSuites.slice(i, i + batchSize);
                    const batchPromises = batch.map(async (suiteInfo) => {
                        try {
                            // For COMMON_SUITES or special suites, search across all main folders
                            const isCommonSuite = suiteInfo.category.toUpperCase() === 'COMMON_SUITES';
                            const isSearchAllSuite = SEARCH_ALL_FOLDERS_SUITES.includes(suiteInfo.suite);
                            const shouldSearchAll = isCommonSuite || isSearchAllSuite;
                            const foldersToSearch = shouldSearchAll ? allMainFolders : [suiteInfo.category];
                            
                            const validReportFolders = [];
                            let foundInCategory = null;
                            
                            for (const searchCategory of foldersToSearch) {
                                const envData = await getCachedEnvFolder(searchCategory);
                                if (!envData) continue;
                                
                                const { basePath, dateFolders } = envData;
                                
                                // OPTIMIZATION: Only check latest 2 date folders instead of 5
                                for (const folder of dateFolders.slice(0, 2)) {
                                    const suites = await getCachedDateFolder(folder.path);
                                    if (!suites) continue;
                                    
                                    // Find matching suite (case-insensitive)
                                    const matchingSuite = suites.find(s => 
                                        s.toLowerCase() === suiteInfo.suite.toLowerCase()
                                    );
                                    
                                    if (matchingSuite) {
                                        const suitePath = `${folder.path}/${matchingSuite}`;
                                        const stats = await getReportStats(suitePath);
                                        validReportFolders.push({
                                            ...folder,
                                            suitePath: suitePath,
                                            foundCategory: searchCategory,
                                            stats: stats
                                        });
                                        foundInCategory = searchCategory;
                                    }
                                }
                                
                                // If we found reports for search-all suite, stop searching
                                if (shouldSearchAll && validReportFolders.length > 0) {
                                    break;
                                }
                            }
                            
                            return {
                                ...suiteInfo,
                                basePath: foundInCategory ? `/${foundInCategory}/${selectedEnv}` : `/${suiteInfo.category}/${selectedEnv}`,
                                actualCategory: foundInCategory || suiteInfo.category,
                                reportFolders: validReportFolders,
                                latestReport: validReportFolders.length > 0 ? validReportFolders[0] : null
                            };
                        } catch (e) {
                            console.error(`Error fetching suite ${suiteInfo.suite}:`, e);
                            return {
                                ...suiteInfo,
                                basePath: `/${suiteInfo.category}/${selectedEnv}`,
                                actualCategory: suiteInfo.category,
                                reportFolders: [],
                                latestReport: null
                            };
                        }
                    });

                    const batchResults = await Promise.all(batchPromises);
                    results.push(...batchResults);
                }

                ownerSuiteResults = results;
                renderOwnerSuitesREST(results, selectedOwner, dateFilter, selectedEnv);

            } catch (e) {
                console.error('Error fetching owner suites:', e);
                document.getElementById('ownerLoadingState').classList.add('hidden');
                document.getElementById('ownerEmptyState').classList.remove('hidden');
            }
        }

        // Parse REST API Reports directory listing to find date folders
        function parseDateFolders(html, basePath, dateFilter) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const rows = doc.querySelectorAll('table tr');
            const folders = [];

            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 3) {
                    const typeCell = cells[0].textContent.trim();
                    const nameCell = cells[1].textContent.trim();
                    const linkCell = cells[2].querySelector('a');

                    if (nameCell && linkCell && typeCell.includes('Directory') && !nameCell.includes('Back to Parent')) {
                        // Folder names are like: Dec_08_2025_22_43_authentication-service_2613
                        const folderName = nameCell;
                        
                        // Extract date from folder name (format: Mon_DD_YYYY)
                        const dateMatch = folderName.match(/([A-Za-z]{3})_(\d{2})_(\d{4})/);
                        let folderDate = null;
                        if (dateMatch) {
                            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                            const monthIndex = monthNames.indexOf(dateMatch[1]);
                            if (monthIndex !== -1) {
                                folderDate = `${dateMatch[3]}-${String(monthIndex + 1).padStart(2, '0')}-${dateMatch[2]}`;
                            }
                        }

                        // If date filter is set, only include matching folders
                        if (dateFilter && folderDate !== dateFilter) {
                            return;
                        }

                        folders.push({
                            name: folderName,
                            path: `${basePath}/${folderName}`,
                            date: folderDate,
                            displayDate: dateMatch ? `${dateMatch[1]} ${dateMatch[2]}, ${dateMatch[3]}` : null
                        });
                    }
                }
            });

            // Sort by date (newest first) - also by folder name to get latest run
            folders.sort((a, b) => {
                if (!a.date || !b.date) return 0;
                // First sort by date, then by folder name (which includes time)
                const dateCompare = b.date.localeCompare(a.date);
                if (dateCompare !== 0) return dateCompare;
                return b.name.localeCompare(a.name);
            });

            return folders;
        }

        function generatePossibleSuiteNames(suiteInfo) {
            const { category, suite } = suiteInfo;
            // ReportPortal uses format: "CATEGORY SUITENAME AUTOMATION TESTS STAGING"
            // e.g., "EDI-SUITES EDI2 AUTOMATION TESTS STAGING"
            // Underscores in CSV suite names become spaces in ReportPortal
            // Categories keep their hyphens
            
            const catUpper = category.toUpperCase();
            // Replace underscores with spaces and uppercase
            const suiteNoUnderscores = suite.replace(/_/g, ' ').toUpperCase();
            // Keep dots in version numbers like "2.0"
            const suiteFormatted = suiteNoUnderscores;
            
            const names = [
                // Primary pattern: CATEGORY SUITE AUTOMATION TESTS STAGING
                `${catUpper} ${suiteFormatted} AUTOMATION TESTS STAGING`,
                // With original case
                `${catUpper} ${suite.replace(/_/g, ' ')} AUTOMATION TESTS STAGING`,
                // Try with underscores kept
                `${catUpper} ${suite.toUpperCase()} AUTOMATION TESTS STAGING`,
                // Without category
                `${suiteFormatted} AUTOMATION TESTS STAGING`,
                // Alternative category formats
                `${catUpper.replace(/-/g, ' ')} ${suiteFormatted} AUTOMATION TESTS STAGING`,
                // Exact matches
                suite,
                suite.toUpperCase(),
                suite.replace(/_/g, ' '),
                suite.replace(/_/g, ' ').toUpperCase()
            ];
            
            console.log(`Trying suite names for ${category}/${suite}:`, names.slice(0, 3));
            return names;
        }

        function renderOwnerSuitesREST(results, ownerName, dateFilter, selectedEnv) {
            document.getElementById('ownerLoadingState').classList.add('hidden');
            document.getElementById('ownerSuitesContainer').classList.remove('hidden');

            // Update header
            document.getElementById('selectedOwnerName').textContent = ownerName;
            
            // Calculate stats
            const suitesWithReports = results.filter(r => r.latestReport);
            
            document.getElementById('selectedOwnerStats').textContent = 
                dateFilter 
                    ? `${suitesWithReports.length} suites with reports on ${formatDateDisplay(dateFilter)}`
                    : `${results.length} assigned suites â€¢ ${suitesWithReports.length} with reports`;

            document.getElementById('ownerPassedCount').textContent = suitesWithReports.length;
            document.getElementById('ownerFailedCount').textContent = results.length - suitesWithReports.length;
            document.getElementById('ownerTotalCount').textContent = results.length;

            // Render grid
            const grid = document.getElementById('ownerSuitesGrid');
            
            if (results.length === 0) {
                grid.innerHTML = `
                    <div class="no-owner-suites" style="grid-column: 1 / -1;">
                        <div class="no-owner-suites-icon">ðŸ“­</div>
                        <h4>No Suites Found</h4>
                        <p>No test suites are assigned to this owner.</p>
                    </div>
                `;
                return;
            }

            // Sort: suites with reports first, then by category
            const sortedResults = [...results].sort((a, b) => {
                if (!a.latestReport && !b.latestReport) return a.category.localeCompare(b.category);
                if (!a.latestReport) return 1;
                if (!b.latestReport) return -1;
                return 0;
            });
            
            // Store sorted results for click handling
            window.sortedOwnerResults = sortedResults;
            
            grid.innerHTML = sortedResults.map((result, index) => {
                const hasReport = result.latestReport !== null;
                const status = hasReport ? 'has-report' : 'no-runs';
                const reportCount = result.reportFolders?.length || 0;
                const isCommonSuite = result.category.toUpperCase() === 'COMMON_SUITES';
                const SEARCH_ALL_FOLDERS_SUITES = ['Phase_0_SampleIntegration_Install'];
                const isSearchAllSuite = SEARCH_ALL_FOLDERS_SUITES.includes(result.suite);
                const shouldSearchAll = isCommonSuite || isSearchAllSuite;
                const actualCategory = result.actualCategory || result.category;
                const foundInDifferentFolder = shouldSearchAll && hasReport && actualCategory !== result.category;
                
                return `
                    <div class="owner-suite-card ${status}" 
                         data-index="${index}"
                         data-has-report="${hasReport}">
                        <div class="owner-suite-card-header">
                            <div class="owner-suite-name">
                                <span class="suite-category">${result.category}</span>
                                <span>${result.suite}</span>
                            </div>
                            <div class="owner-suite-status ${hasReport ? 'passed' : 'no-runs'}">
                                ${hasReport ? `${reportCount} Report${reportCount > 1 ? 's' : ''}` : 'No Reports'}
                            </div>
                        </div>
                        ${hasReport ? `
                            <div class="owner-suite-stats">
                                <span style="color: var(--accent-cyan)">ðŸ“… ${result.latestReport.displayDate || 'Recent'}</span>
                                ${foundInDifferentFolder ? `<span style="color: var(--accent-purple)">ðŸ“ Found in: ${actualCategory}</span>` : ''}
                            </div>
                            ${result.latestReport.stats ? `
                            <div class="owner-suite-stats" style="margin-top: 0.5rem;">
                                <span class="passed">âœ“ ${result.latestReport.stats.passed}</span>
                                <span class="failed">âœ— ${result.latestReport.stats.failed}</span>
                                <span class="total">Total: ${result.latestReport.stats.total}</span>
                            </div>
                            ` : ''}
                            <div class="owner-suite-meta">
                                <span>ðŸ“‚ ${selectedEnv}</span>
                                <span>ðŸ”— Click to view</span>
                                <div class="report-action-buttons">
                                    <a href="#" 
                                       target="_blank" 
                                       class="direct-report-link"
                                       data-report-path="${result.latestReport.suitePath}/index.html"
                                       onclick="openReportLink(event, this.dataset.reportPath)"
                                       title="Open Report Directly">ðŸ”—</a>
                                    <button class="copy-link-btn"
                                            data-report-path="${result.latestReport.suitePath}/index.html"
                                            onclick="copyReportLinkByPath(this.dataset.reportPath, event)"
                                            title="Copy Report Link">ðŸ“‹</button>
                                </div>
                            </div>
                        ` : `
                            <div class="owner-suite-stats" style="color: var(--text-muted)">
                                ${shouldSearchAll ? 'Searched all folders - No reports found' : `No reports found in ${selectedEnv}`}
                            </div>
                            <div class="owner-suite-meta">
                                <span style="color: var(--text-muted)">ðŸ“‚ ${result.basePath}</span>
                            </div>
                        `}
                    </div>
                `;
            }).join('');
            
            // Add click handlers to suite cards
            grid.querySelectorAll('.owner-suite-card').forEach(card => {
                card.addEventListener('click', async () => {
                    const index = parseInt(card.dataset.index);
                    const hasReport = card.dataset.hasReport === 'true';
                    const result = window.sortedOwnerResults[index];
                    
                    if (hasReport && result && result.latestReport) {
                        // Open the report in a new tab
                        const reportUrl = await buildAuthUrl(REST_REPORTS_CONFIG.directUrl, `${result.latestReport.suitePath}/index.html`);
                        if (reportUrl) {
                            window.open(reportUrl, '_blank');
                        }
                    } else if (result) {
                        // Show all report folders for this suite
                        showOwnerSuiteFolders(result);
                    }
                });
            });
        }

        // Show available report folders for a suite
        function showOwnerSuiteFolders(result) {
            const selectedEnv = document.getElementById('ownerEnvSelect').value;
            
            if (result.reportFolders && result.reportFolders.length > 0) {
                // Show list of available reports
                document.getElementById('ownerSuitesContainer').classList.add('hidden');
                
                const detailCard = document.getElementById('ownerSuiteDetailCard');
                detailCard.innerHTML = `
                    <div class="report-header">
                        <button class="back-btn" onclick="backToOwnerSuitesList()">â† Back to API Owners</button>
                        <div class="report-title">${result.category} / ${result.suite}</div>
                    </div>
                    <div style="padding: 1.5rem;">
                        <h4 style="margin-bottom: 1rem; color: var(--accent-cyan);">ðŸ“ Available Reports (${result.reportFolders.length})</h4>
                        <div class="reports-grid">
                            ${result.reportFolders.map(folder => `
                                <div class="report-card-mini ${folder.stats && folder.stats.failed > 0 ? 'failed' : 'passed'}" 
                                     style="cursor: pointer;" 
                                     data-report-path="${folder.suitePath}/index.html"
                                     onclick="openReportLink(event, this.dataset.reportPath)">
                                    <div class="report-card-mini-header">
                                        <div class="report-card-mini-title">
                                            <span>ðŸ“… ${folder.displayDate || 'Report'}</span>
                                        </div>
                                        <button class="copy-link-btn"
                                                data-report-path="${folder.suitePath}/index.html"
                                                onclick="copyReportLinkByPath(this.dataset.reportPath, event)"
                                                title="Copy Report Link">ðŸ“‹</button>
                                    </div>
                                    ${folder.stats ? `
                                    <div class="report-card-mini-stats">
                                        <span class="passed">âœ“ ${folder.stats.passed}</span>
                                        <span class="failed">âœ— ${folder.stats.failed}</span>
                                        <span style="color: var(--text-secondary)">Total: ${folder.stats.total}</span>
                                    </div>
                                    ` : ''}
                                    <div class="report-card-mini-meta">
                                        <span>${folder.name}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                detailCard.classList.remove('hidden');
            } else {
                // Open the base folder in REST API Reports tab
                alert(`No reports found for ${result.suite} in ${selectedEnv}.\n\nPath: ${result.basePath}`);
            }
        }

        function backToOwnerSuitesList() {
            document.getElementById('ownerSuiteDetailCard').classList.add('hidden');
            document.getElementById('ownerSuitesContainer').classList.remove('hidden');
        }

        // ==================== UI OWNERS TAB ====================
        function initUiOwnerSuitesTab() {
            if (uiOwnerTabInitialized) return;
            uiOwnerTabInitialized = true;

            // Get unique owners and sort them
            const owners = [...new Set(UI_OWNER_SUITE_MAPPING.map(m => m.owner).filter(o => o && o.trim()))].sort();
            
            // Helper function to count unique suites (case-insensitive) for an owner
            function getUniqueUiSuiteCount(owner) {
                const ownerSuites = UI_OWNER_SUITE_MAPPING.filter(m => m.owner === owner);
                const uniqueNames = new Set(ownerSuites.map(m => m.suite.toLowerCase()));
                return uniqueNames.size;
            }
            
            const uiOwnerSelect = document.getElementById('uiOwnerSelect');
            uiOwnerSelect.innerHTML = '<option value="">-- Select a UI Owner --</option>' +
                owners.map(owner => {
                    const count = getUniqueUiSuiteCount(owner);
                    return `<option value="${owner}">${owner} (${count} suites)</option>`;
                }).join('');

            // Setup event listeners
            const fetchBtn = document.getElementById('fetchUiOwnerSuitesBtn');
            const dateFilter = document.getElementById('uiOwnerDateFilter');
            const clearDateBtn = document.getElementById('clearUiOwnerDateFilter');
            const envSelect = document.getElementById('uiOwnerEnvSelect');

            uiOwnerSelect.addEventListener('change', () => {
                fetchBtn.disabled = !uiOwnerSelect.value;
                if (uiOwnerSelect.value) {
                    fetchUiOwnerSuites();
                }
            });

            fetchBtn.addEventListener('click', fetchUiOwnerSuites);

            dateFilter.addEventListener('change', () => {
                if (uiOwnerSelect.value) {
                    fetchUiOwnerSuites();
                }
            });

            clearDateBtn.addEventListener('click', () => {
                dateFilter.value = '';
                if (uiOwnerSelect.value) {
                    fetchUiOwnerSuites();
                }
            });

            envSelect.addEventListener('change', () => {
                if (uiOwnerSelect.value) {
                    fetchUiOwnerSuites();
                }
            });
        }

        async function fetchUiOwnerSuites() {
            const uiOwnerSelect = document.getElementById('uiOwnerSelect');
            const dateFilter = document.getElementById('uiOwnerDateFilter').value;
            const envSelect = document.getElementById('uiOwnerEnvSelect');
            const selectedOwner = uiOwnerSelect.value;
            const selectedEnv = envSelect.value;

            if (!selectedOwner) return;

            // Map environment to project name
            const projectMap = {
                'staging': 'staging_suites',
                'qa': 'qa_suites'
            };
            const projectName = projectMap[selectedEnv] || 'staging_suites';

            // Show loading state
            document.getElementById('uiOwnerEmptyState').classList.add('hidden');
            document.getElementById('uiOwnerSuitesContainer').classList.add('hidden');
            document.getElementById('uiOwnerLoadingState').classList.remove('hidden');

            // Get suites for this owner from the UI mapping (deduplicated)
            const ownerSuitesRaw = UI_OWNER_SUITE_MAPPING.filter(m => m.owner === selectedOwner);
            const seenSuiteNames = new Set();
            selectedUiOwnerSuites = ownerSuitesRaw.filter(m => {
                const normalizedName = m.suite.toLowerCase();
                if (seenSuiteNames.has(normalizedName)) {
                    return false;
                }
                seenSuiteNames.add(normalizedName);
                return true;
            });
            
            console.log(`Fetching UI reports for owner: ${selectedOwner}, env: ${selectedEnv}, date: ${dateFilter || 'any'}`);
            console.log(`Found ${selectedUiOwnerSuites.length} suites for UI owner`);

            try {
                // Fetch from ReportPortal for UI suites
                const results = [];
                
                for (const suiteInfo of selectedUiOwnerSuites) {
                    try {
                        // Search for the suite in ReportPortal
                        const searchName = `PLATFORM_UI_AUTOMATION_${suiteInfo.suite}`;
                        
                        // Build API URL with date filter if specified
                        let apiUrl = `/api/v1/${projectName}/launch?filter.eq.name=${encodeURIComponent(searchName)}&page.sort=startTime,desc`;
                        
                        if (dateFilter) {
                            // Filter by date: get all reports from that day using gte and lte filters
                            const startOfDay = new Date(dateFilter + 'T00:00:00');
                            const endOfDay = new Date(dateFilter + 'T23:59:59.999');
                            apiUrl += `&filter.gte.startTime=${startOfDay.getTime()}&filter.lte.startTime=${endOfDay.getTime()}&page.size=50`;
                        } else {
                            // No date filter: get latest report only
                            apiUrl += '&page.size=1';
                        }
                        
                        const response = await fetch(apiUrl);
                        
                        if (response.ok) {
                            const data = await response.json();
                            if (data.content && data.content.length > 0) {
                                // Use the first matching launch (API already filtered by date if specified)
                                const matchingLaunch = data.content[0];
                                
                                results.push({
                                    team: suiteInfo.team,
                                    suite: suiteInfo.suite,
                                    owner: suiteInfo.owner,
                                    latestReport: {
                                        id: matchingLaunch.id,
                                        name: matchingLaunch.name,
                                        status: matchingLaunch.status,
                                        startTime: matchingLaunch.startTime,
                                        statistics: matchingLaunch.statistics,
                                        displayDate: new Date(matchingLaunch.startTime).toLocaleDateString('en-US', { 
                                            month: 'short', day: '2-digit', year: 'numeric' 
                                        })
                                    }
                                });
                            } else {
                                results.push({
                                    team: suiteInfo.team,
                                    suite: suiteInfo.suite,
                                    owner: suiteInfo.owner,
                                    latestReport: null
                                });
                            }
                        } else {
                            results.push({
                                team: suiteInfo.team,
                                suite: suiteInfo.suite,
                                owner: suiteInfo.owner,
                                latestReport: null
                            });
                        }
                    } catch (e) {
                        results.push({
                            team: suiteInfo.team,
                            suite: suiteInfo.suite,
                            owner: suiteInfo.owner,
                            latestReport: null
                        });
                    }
                }

                uiOwnerSuiteResults = results;
                renderUiOwnerSuites(results, selectedOwner, dateFilter, projectName);

            } catch (e) {
                console.error('Error fetching UI owner suites:', e);
                document.getElementById('uiOwnerLoadingState').classList.add('hidden');
                document.getElementById('uiOwnerEmptyState').classList.remove('hidden');
            }
        }

        function renderUiOwnerSuites(results, ownerName, dateFilter, projectName = 'staging_suites') {
            document.getElementById('uiOwnerLoadingState').classList.add('hidden');
            document.getElementById('uiOwnerSuitesContainer').classList.remove('hidden');

            // Update header
            document.getElementById('selectedUiOwnerName').textContent = ownerName;
            
            // Calculate stats
            const suitesWithReports = results.filter(r => r.latestReport);
            
            document.getElementById('selectedUiOwnerStats').textContent = 
                dateFilter 
                    ? `${suitesWithReports.length} suites with reports on ${dateFilter}`
                    : `${results.length} assigned suites â€¢ ${suitesWithReports.length} with reports`;

            document.getElementById('uiOwnerPassedCount').textContent = suitesWithReports.length;
            document.getElementById('uiOwnerFailedCount').textContent = results.length - suitesWithReports.length;
            document.getElementById('uiOwnerTotalCount').textContent = results.length;

            // Render grid
            const grid = document.getElementById('uiOwnerSuitesGrid');
            
            if (results.length === 0) {
                grid.innerHTML = `
                    <div class="no-owner-suites" style="grid-column: 1 / -1;">
                        <div class="no-owner-suites-icon">ðŸ“­</div>
                        <h4>No Suites Found</h4>
                        <p>No UI test suites are assigned to this owner.</p>
                    </div>
                `;
                return;
            }

            // Sort: suites with reports first, then by team
            const sortedResults = [...results].sort((a, b) => {
                if (!a.latestReport && !b.latestReport) return a.team.localeCompare(b.team);
                if (!a.latestReport) return 1;
                if (!b.latestReport) return -1;
                return 0;
            });
            
            grid.innerHTML = sortedResults.map((result, index) => {
                const hasReport = result.latestReport !== null;
                const status = hasReport ? 'has-report' : 'no-runs';
                const stats = result.latestReport?.statistics?.executions || {};
                const passed = stats.passed || 0;
                const failed = stats.failed || 0;
                const total = stats.total || 0;
                
                return `
                    <div class="owner-suite-card ${status}" 
                         data-index="${index}"
                         data-has-report="${hasReport}"
                         data-launch-id="${result.latestReport?.id || ''}">
                        <div class="owner-suite-card-header">
                            <div class="owner-suite-name">
                                <span class="suite-category">${result.team}</span>
                                <span>${result.suite}</span>
                            </div>
                            <div class="owner-suite-status ${hasReport ? 'passed' : 'no-runs'}">
                                ${hasReport ? 'âœ… Has Report' : 'No Reports'}
                            </div>
                        </div>
                        ${hasReport ? `
                            <div class="owner-suite-stats">
                                <span style="color: var(--accent-cyan)">ðŸ“… ${result.latestReport.displayDate}</span>
                                <span style="color: var(--accent-green)">âœ“ ${passed}</span>
                                <span style="color: var(--accent-red)">âœ— ${failed}</span>
                            </div>
                            <div class="owner-suite-meta">
                                <span>Total: ${total}</span>
                                <span>ðŸ”— Click to view</span>
                                <div class="report-action-buttons">
                                    <a href="https://reportportal.qa.staging.integrator.io/ui/#${projectName}/launches/all/${result.latestReport?.id || ''}" 
                                       target="_blank" 
                                       class="direct-report-link"
                                       onclick="event.stopPropagation();"
                                       title="Open Report Directly">ðŸ”—</a>
                                    <button class="copy-link-btn"
                                            onclick="copyReportLink('https://reportportal.qa.staging.integrator.io/ui/#${projectName}/launches/all/${result.latestReport?.id || ''}', event)"
                                            title="Copy Report Link">ðŸ“‹</button>
                                </div>
                            </div>
                        ` : `
                            <div class="owner-suite-stats" style="color: var(--text-muted)">
                                No reports found in ReportPortal
                            </div>
                            <div class="owner-suite-meta">
                                <span style="color: var(--text-muted)">Suite: PLATFORM_UI_AUTOMATION_${result.suite}</span>
                            </div>
                        `}
                    </div>
                `;
            }).join('');
            
            // Add click handlers to suite cards
            grid.querySelectorAll('.owner-suite-card').forEach(card => {
                card.addEventListener('click', () => {
                    const hasReport = card.dataset.hasReport === 'true';
                    const launchId = card.dataset.launchId;
                    
                    if (hasReport && launchId) {
                        // Open ReportPortal in a new tab
                        const reportUrl = `https://reportportal.qa.staging.integrator.io/ui/#${projectName}/launches/all/${launchId}`;
                        window.open(reportUrl, '_blank');
                    }
                });
            });
        }


        async function showOwnerSuiteDetail(result) {
            if (!result.launch) {
                // No launch data, nothing to show
                return;
            }

            document.getElementById('ownerSuitesContainer').classList.add('hidden');
            document.getElementById('ownerLoadingState').classList.remove('hidden');

            const launch = result.launch;
            const stats = launch.statistics?.executions || {};

            // Update detail card
            document.getElementById('ownerDetailSuiteName').textContent = result.suite;
            document.getElementById('ownerDetailStatus').textContent = launch.status;
            document.getElementById('ownerDetailStatus').className = `status-badge ${launch.status.toLowerCase()}`;
            document.getElementById('ownerDetailTotal').textContent = stats.total || 0;
            document.getElementById('ownerDetailPassed').textContent = stats.passed || 0;
            document.getElementById('ownerDetailFailed').textContent = stats.failed || 0;
            document.getElementById('ownerDetailDuration').textContent = Math.round((launch.approximateDuration || 0) / 60) + 'm';
            document.getElementById('ownerDetailLaunchId').textContent = launch.id;
            document.getElementById('ownerDetailRunNumber').textContent = '#' + launch.number;
            document.getElementById('ownerDetailBuildDate').textContent = launch.attributes?.find(a => a.key === 'Build')?.value || 'N/A';
            document.getElementById('ownerDetailOwner').textContent = launch.owner || result.owner;
            document.getElementById('ownerDetailPlatform').textContent = launch.attributes?.find(a => a.key === 'Platform')?.value || 'N/A';
            
            const selectedEnv = document.getElementById('ownerEnvSelect').value;
            document.getElementById('ownerDetailLink').href = `${CONFIG.RP_DIRECT}/ui/#${selectedEnv}/launches/all/${launch.id}`;

            // Fetch failed tests if any
            if (stats.failed > 0) {
                try {
                    const failedResponse = await fetch(
                        `${CONFIG.RP_HOST}/api/v1/${selectedEnv}/item?filter.eq.launchId=${launch.id}&filter.eq.status=FAILED&page.size=20`
                    );
                    const failedData = await failedResponse.json();
                    const failedTests = failedData.content.filter(i => i.type === 'STEP');

                    document.getElementById('ownerDetailFailedList').innerHTML = failedTests.map((test, i) => `
                        <div class="failed-test-item">
                            <div class="failed-test-num">${i + 1}</div>
                            <div class="failed-test-name">${test.name}</div>
                        </div>
                    `).join('');
                    document.getElementById('ownerDetailFailedPanel').classList.remove('hidden');
                } catch (e) {
                    console.error('Error fetching failed tests:', e);
                    document.getElementById('ownerDetailFailedPanel').classList.add('hidden');
                }
            } else {
                document.getElementById('ownerDetailFailedPanel').classList.add('hidden');
            }

            document.getElementById('ownerLoadingState').classList.add('hidden');
            document.getElementById('ownerSuiteDetailCard').classList.remove('hidden');
        }

        // Update tab setup to include Owner tab initialization
        const originalSetupTabs = setupTabs;
        setupTabs = function() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(btn.dataset.tab + 'Tab').classList.add('active');

                    // Initialize tabs on first view
                    if (btn.dataset.tab === 'restapi' && !restApiInitialized) {
                        restApiInitialized = true;
                        setupRestApiReportsListeners();
                        initRestApiReports();
                    }
                    
                    if (btn.dataset.tab === 'owner' && !ownerTabInitialized) {
                        initOwnerTab();
                    }
                    
                    // Initialize UI Owner Suites on first view
                    if (btn.dataset.tab === 'uiowner' && !uiOwnerTabInitialized) {
                        initUiOwnerSuitesTab();
                    }
                    
                    // Initialize Suite Management on first view
                    if (btn.dataset.tab === 'suitemgmt' && !suiteManagementInitialized) {
                        initSuiteManagement();
                    }
                });
            });
        };

        // ==================== SUITE MANAGEMENT ====================
        let suiteManagementInitialized = false;
        let customSuites = [];
        const CUSTOM_SUITES_KEY = 'reportportal_custom_suites';
        let validMainFolders = [];
        let validApiOwners = [];
        let folderOwnerMap = {};
        let highlightedAutocompleteIndex = -1;
        let currentSortColumn = 'mainFolder';
        let currentSortDirection = 'asc';
        let pendingDeleteId = null;

        function initSuiteManagement() {
            if (suiteManagementInitialized) return;
            suiteManagementInitialized = true;

            // Get unique main folders (categories) from OWNER_SUITE_MAPPING
            const folderCounts = {};
            const ownerCounts = {};
            OWNER_SUITE_MAPPING.forEach(item => {
                const folder = item.category;
                const owner = item.owner;
                folderCounts[folder] = (folderCounts[folder] || 0) + 1;
                if (owner) {
                    ownerCounts[owner] = (ownerCounts[owner] || 0) + 1;
                    // Map folders to owners
                    if (!folderOwnerMap[folder]) folderOwnerMap[folder] = new Set();
                    folderOwnerMap[folder].add(owner);
                }
            });
            
            validMainFolders = Object.keys(folderCounts).sort().map(folder => ({
                name: folder,
                count: folderCounts[folder]
            }));
            
            validApiOwners = Object.keys(ownerCounts).sort().map(owner => ({
                name: owner,
                count: ownerCounts[owner]
            }));
            
            console.log(`Loaded ${validMainFolders.length} folders, ${validApiOwners.length} owners from API mapping`);

            // Load existing suites from localStorage
            loadCustomSuites();
            renderSuitesTable();
            setupSuiteManagementListeners();
            setupMainFolderAutocomplete();
            setupApiOwnerAutocomplete();
            setupSortableHeaders();
            setupDeleteModal();
            updateFilterTags();
            updateSuiteStats();
        }

        function loadCustomSuites() {
            try {
                const stored = localStorage.getItem(CUSTOM_SUITES_KEY);
                customSuites = stored ? JSON.parse(stored) : [];
            } catch (e) {
                console.error('Error loading custom suites:', e);
                customSuites = [];
            }
        }

        function saveCustomSuites() {
            try {
                localStorage.setItem(CUSTOM_SUITES_KEY, JSON.stringify(customSuites));
            } catch (e) {
                console.error('Error saving custom suites:', e);
                showToast('âŒ Failed to save suites');
            }
        }

        function setupSuiteManagementListeners() {
            // Form submission
            document.getElementById('suiteManagementForm').addEventListener('submit', handleSuiteFormSubmit);
            
            // Clear form button
            document.getElementById('clearFormBtn').addEventListener('click', clearSuiteForm);
            
            // Search input
            document.getElementById('suiteSearchInput').addEventListener('input', (e) => {
                renderSuitesTable(e.target.value);
            });
            
            // Filter tags
            document.getElementById('suiteFilterTags').addEventListener('click', (e) => {
                if (e.target.classList.contains('filter-tag')) {
                    document.querySelectorAll('.filter-tag').forEach(tag => tag.classList.remove('active'));
                    e.target.classList.add('active');
                    renderSuitesTable(document.getElementById('suiteSearchInput').value);
                }
            });
            
            // Export button
            document.getElementById('exportSuitesBtn').addEventListener('click', exportSuites);
            
            // Import button
            document.getElementById('importSuitesBtn').addEventListener('click', () => {
                document.getElementById('importModal').classList.add('show');
            });
            
            // Import modal controls
            document.getElementById('closeImportModal').addEventListener('click', closeImportModal);
            document.getElementById('cancelImportBtn').addEventListener('click', closeImportModal);
            document.getElementById('confirmImportBtn').addEventListener('click', importSuites);
            
            // Close modal on backdrop click
            document.getElementById('importModal').addEventListener('click', (e) => {
                if (e.target.id === 'importModal') closeImportModal();
            });
        }

        function setupMainFolderAutocomplete() {
            const input = document.getElementById('mainFolderInput');
            const dropdown = document.getElementById('mainFolderDropdown');
            const validation = document.getElementById('mainFolderValidation');
            
            // Input event - show autocomplete
            input.addEventListener('input', () => {
                const query = input.value.trim().toLowerCase();
                highlightedAutocompleteIndex = -1;
                
                if (!query) {
                    dropdown.classList.remove('show');
                    input.classList.remove('input-validation-error', 'input-validation-success');
                    validation.innerHTML = '';
                    return;
                }
                
                // Filter matching folders
                const matches = validMainFolders.filter(f => 
                    f.name.toLowerCase().includes(query)
                );
                
                if (matches.length === 0) {
                    // No matches - show error
                    dropdown.innerHTML = `
                        <div class="autocomplete-no-match">
                            <div class="autocomplete-no-match-icon">âŒ</div>
                            <div>No matching folder found</div>
                            <div style="font-size: 0.75rem; margin-top: 0.25rem; color: var(--text-muted)">
                                Only existing API folders are allowed
                            </div>
                        </div>
                    `;
                    dropdown.classList.add('show');
                    input.classList.add('input-validation-error');
                    input.classList.remove('input-validation-success');
                    validation.innerHTML = '<span class="validation-message error">âš ï¸ Folder must exist in API mapping</span>';
                } else {
                    // Show matches
                    dropdown.innerHTML = matches.map((folder, index) => `
                        <div class="autocomplete-item" data-folder="${folder.name}" data-index="${index}">
                            <span class="autocomplete-item-icon">ðŸ“</span>
                            <span class="autocomplete-item-text">${highlightMatch(folder.name, query)}</span>
                            <span class="autocomplete-item-count">${folder.count} suite${folder.count > 1 ? 's' : ''}</span>
                        </div>
                    `).join('');
                    dropdown.classList.add('show');
                    
                    // Check if exact match
                    const exactMatch = matches.some(f => f.name.toLowerCase() === query);
                    if (exactMatch) {
                        input.classList.add('input-validation-success');
                        input.classList.remove('input-validation-error');
                        validation.innerHTML = '<span class="validation-message success">âœ“ Valid folder</span>';
                    } else {
                        input.classList.remove('input-validation-error', 'input-validation-success');
                        validation.innerHTML = '<span class="validation-message" style="color: var(--text-muted)">Select from suggestions below</span>';
                    }
                    
                    // Add click handlers
                    dropdown.querySelectorAll('.autocomplete-item').forEach(item => {
                        item.addEventListener('click', () => {
                            selectMainFolder(item.dataset.folder);
                        });
                    });
                }
            });
            
            // Keyboard navigation
            input.addEventListener('keydown', (e) => {
                const items = dropdown.querySelectorAll('.autocomplete-item');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    highlightedAutocompleteIndex = Math.min(highlightedAutocompleteIndex + 1, items.length - 1);
                    updateAutocompleteHighlight(items);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    highlightedAutocompleteIndex = Math.max(highlightedAutocompleteIndex - 1, 0);
                    updateAutocompleteHighlight(items);
                } else if (e.key === 'Enter' && highlightedAutocompleteIndex >= 0 && dropdown.classList.contains('show')) {
                    e.preventDefault();
                    const selectedItem = items[highlightedAutocompleteIndex];
                    if (selectedItem) {
                        selectMainFolder(selectedItem.dataset.folder);
                    }
                } else if (e.key === 'Escape') {
                    dropdown.classList.remove('show');
                }
            });
            
            // Focus event - show all if empty
            input.addEventListener('focus', () => {
                if (!input.value.trim()) {
                    showAllFolders();
                }
            });
            
            // Click outside to close
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.autocomplete-wrapper')) {
                    dropdown.classList.remove('show');
                }
            });
        }

        function showAllFolders() {
            const dropdown = document.getElementById('mainFolderDropdown');
            dropdown.innerHTML = validMainFolders.map((folder, index) => `
                <div class="autocomplete-item" data-folder="${folder.name}" data-index="${index}">
                    <span class="autocomplete-item-icon">ðŸ“</span>
                    <span class="autocomplete-item-text">${folder.name}</span>
                    <span class="autocomplete-item-count">${folder.count} suite${folder.count > 1 ? 's' : ''}</span>
                </div>
            `).join('');
            dropdown.classList.add('show');
            
            dropdown.querySelectorAll('.autocomplete-item').forEach(item => {
                item.addEventListener('click', () => {
                    selectMainFolder(item.dataset.folder);
                });
            });
        }

        function selectMainFolder(folderName) {
            const input = document.getElementById('mainFolderInput');
            const dropdown = document.getElementById('mainFolderDropdown');
            const validation = document.getElementById('mainFolderValidation');
            
            input.value = folderName;
            dropdown.classList.remove('show');
            input.classList.add('input-validation-success');
            input.classList.remove('input-validation-error');
            validation.innerHTML = '<span class="validation-message success">âœ“ Valid folder selected</span>';
            
            // Focus on next field
            document.getElementById('subFolderInput').focus();
        }

        function updateAutocompleteHighlight(items) {
            items.forEach((item, i) => {
                item.classList.toggle('highlighted', i === highlightedAutocompleteIndex);
            });
            if (items[highlightedAutocompleteIndex]) {
                items[highlightedAutocompleteIndex].scrollIntoView({ block: 'nearest' });
            }
        }

        function highlightMatch(text, query) {
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<strong style="color: var(--accent-cyan)">$1</strong>');
        }

        function isValidMainFolder(folderName) {
            return validMainFolders.some(f => f.name.toLowerCase() === folderName.toLowerCase());
        }

        // API Owner Autocomplete
        function setupApiOwnerAutocomplete() {
            const input = document.getElementById('apiOwnerInput');
            const dropdown = document.getElementById('apiOwnerDropdown');
            const suggestion = document.getElementById('apiOwnerSuggestion');
            
            input.addEventListener('input', () => {
                const query = input.value.trim().toLowerCase();
                highlightedAutocompleteIndex = -1;
                
                if (!query) {
                    dropdown.classList.remove('show');
                    suggestion.innerHTML = '';
                    return;
                }
                
                // Filter matching owners
                const matches = validApiOwners.filter(o => 
                    o.name.toLowerCase().includes(query)
                );
                
                if (matches.length === 0) {
                    dropdown.innerHTML = `
                        <div class="autocomplete-item" style="color: var(--text-muted); cursor: default;">
                            <span class="autocomplete-item-icon">ðŸ‘¤</span>
                            <span>New owner: "${input.value}"</span>
                        </div>
                    `;
                    dropdown.classList.add('show');
                    suggestion.innerHTML = '<span style="color: var(--accent-yellow)">â„¹ï¸ New owner will be added</span>';
                } else {
                    dropdown.innerHTML = matches.slice(0, 8).map((owner, index) => `
                        <div class="autocomplete-item" data-owner="${owner.name}" data-index="${index}">
                            <span class="autocomplete-item-icon">ðŸ‘¤</span>
                            <span class="autocomplete-item-text">${highlightMatch(owner.name, query)}</span>
                            <span class="autocomplete-item-count">${owner.count} suite${owner.count > 1 ? 's' : ''}</span>
                        </div>
                    `).join('');
                    dropdown.classList.add('show');
                    suggestion.innerHTML = '';
                    
                    dropdown.querySelectorAll('.autocomplete-item').forEach(item => {
                        item.addEventListener('click', () => {
                            if (item.dataset.owner) {
                                input.value = item.dataset.owner;
                                dropdown.classList.remove('show');
                            }
                        });
                    });
                }
            });
            
            input.addEventListener('keydown', (e) => {
                const items = dropdown.querySelectorAll('.autocomplete-item[data-owner]');
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    highlightedAutocompleteIndex = Math.min(highlightedAutocompleteIndex + 1, items.length - 1);
                    updateAutocompleteHighlight(items);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    highlightedAutocompleteIndex = Math.max(highlightedAutocompleteIndex - 1, 0);
                    updateAutocompleteHighlight(items);
                } else if (e.key === 'Enter' && highlightedAutocompleteIndex >= 0) {
                    e.preventDefault();
                    const selectedItem = items[highlightedAutocompleteIndex];
                    if (selectedItem && selectedItem.dataset.owner) {
                        input.value = selectedItem.dataset.owner;
                        dropdown.classList.remove('show');
                    }
                } else if (e.key === 'Escape') {
                    dropdown.classList.remove('show');
                }
            });
            
            input.addEventListener('focus', () => {
                // Show suggested owners for selected folder
                const selectedFolder = document.getElementById('mainFolderInput').value.trim();
                if (selectedFolder && folderOwnerMap[selectedFolder]) {
                    const suggestedOwners = Array.from(folderOwnerMap[selectedFolder]);
                    if (suggestedOwners.length > 0) {
                        suggestion.innerHTML = `<span style="color: var(--accent-cyan)">ðŸ’¡ Suggested: ${suggestedOwners.slice(0, 3).join(', ')}</span>`;
                    }
                }
            });
            
            document.addEventListener('click', (e) => {
                if (!e.target.closest('#apiOwnerInput') && !e.target.closest('#apiOwnerDropdown')) {
                    dropdown.classList.remove('show');
                }
            });
        }

        // Sortable Table Headers
        function setupSortableHeaders() {
            document.querySelectorAll('.suite-mgmt-table th.sortable').forEach(th => {
                th.addEventListener('click', () => {
                    const column = th.dataset.sort;
                    
                    // Toggle direction if same column
                    if (currentSortColumn === column) {
                        currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
                    } else {
                        currentSortColumn = column;
                        currentSortDirection = 'asc';
                    }
                    
                    // Update header styles
                    document.querySelectorAll('.suite-mgmt-table th.sortable').forEach(h => {
                        h.classList.remove('asc', 'desc');
                    });
                    th.classList.add(currentSortDirection);
                    
                    renderSuitesTable(document.getElementById('suiteSearchInput').value);
                });
            });
        }

        // Delete Modal
        function setupDeleteModal() {
            document.getElementById('confirmDeleteBtn').addEventListener('click', () => {
                if (pendingDeleteId) {
                    customSuites = customSuites.filter(s => s.id !== pendingDeleteId);
                    saveCustomSuites();
                    renderSuitesTable();
                    updateFilterTags();
                    updateSuiteStats();
                    showToast('ðŸ—‘ï¸ Suite deleted');
                }
                closeDeleteModal();
            });
            
            document.getElementById('cancelDeleteBtn').addEventListener('click', closeDeleteModal);
            
            document.getElementById('deleteModal').addEventListener('click', (e) => {
                if (e.target.id === 'deleteModal') closeDeleteModal();
            });
        }

        function showDeleteModal(id) {
            const suite = customSuites.find(s => s.id === id);
            if (!suite) return;
            
            pendingDeleteId = id;
            document.getElementById('deleteSuiteInfo').textContent = `${suite.mainFolder} / ${suite.subFolder}`;
            document.getElementById('deleteModal').classList.add('show');
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.remove('show');
            pendingDeleteId = null;
        }

        // Update Suite Stats
        function updateSuiteStats() {
            const totalSuites = customSuites.length;
            const uniqueFolders = new Set(customSuites.map(s => s.mainFolder)).size;
            const uniqueOwners = new Set(customSuites.map(s => s.apiOwner).filter(o => o)).size;
            
            document.getElementById('statTotalSuites').textContent = totalSuites;
            document.getElementById('statTotalFolders').textContent = uniqueFolders;
            document.getElementById('statTotalOwners').textContent = uniqueOwners;
        }

        function handleSuiteFormSubmit(e) {
            e.preventDefault();
            
            const mainFolder = document.getElementById('mainFolderInput').value.trim();
            const subFolder = document.getElementById('subFolderInput').value.trim();
            const apiOwner = document.getElementById('apiOwnerInput').value.trim();
            const team = document.getElementById('teamInput').value.trim();
            const description = document.getElementById('descriptionInput').value.trim();
            const editId = document.getElementById('editSuiteId').value;
            
            if (!mainFolder || !subFolder || !apiOwner) {
                showToast('âŒ Main Folder, Sub Folder and API Owner are required');
                return;
            }
            
            // Validate main folder exists in API mapping
            if (!isValidMainFolder(mainFolder)) {
                showToast('âŒ Invalid Main Folder - must be an existing API folder');
                document.getElementById('mainFolderInput').classList.add('input-validation-error');
                document.getElementById('mainFolderValidation').innerHTML = 
                    '<span class="validation-message error">âš ï¸ This folder does not exist in the API mapping</span>';
                document.getElementById('mainFolderInput').focus();
                return;
            }
            
            // Get correct case from valid folders
            const correctFolder = validMainFolders.find(f => f.name.toLowerCase() === mainFolder.toLowerCase());
            const normalizedMainFolder = correctFolder ? correctFolder.name : mainFolder;
            
            const suite = {
                id: editId || Date.now().toString(),
                mainFolder: normalizedMainFolder,
                subFolder,
                apiOwner,
                team,
                description,
                createdAt: editId ? (customSuites.find(s => s.id === editId)?.createdAt || new Date().toISOString()) : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            if (editId) {
                // Update existing suite
                const index = customSuites.findIndex(s => s.id === editId);
                if (index !== -1) {
                    customSuites[index] = suite;
                    showToast('âœ… Suite updated successfully');
                }
            } else {
                // Check for duplicates
                const exists = customSuites.some(s => 
                    s.mainFolder.toLowerCase() === normalizedMainFolder.toLowerCase() && 
                    s.subFolder.toLowerCase() === subFolder.toLowerCase()
                );
                
                if (exists) {
                    showToast('âš ï¸ Suite already exists with this folder structure');
                    return;
                }
                
                customSuites.push(suite);
                showToast('âœ… Suite added successfully');
            }
            
            saveCustomSuites();
            renderSuitesTable();
            updateFilterTags();
            updateSuiteStats();
            clearSuiteForm();
        }

        function clearSuiteForm() {
            document.getElementById('suiteManagementForm').reset();
            document.getElementById('editSuiteId').value = '';
            document.getElementById('suiteFormTitle').textContent = 'Add New API Suite';
            document.getElementById('submitSuiteBtn').innerHTML = '<span>âž•</span> Add Suite';
            document.querySelector('.suite-mgmt-form-icon').textContent = 'âž•';
            
            // Clear validation state
            const mainFolderInput = document.getElementById('mainFolderInput');
            mainFolderInput.classList.remove('input-validation-error', 'input-validation-success');
            document.getElementById('mainFolderValidation').innerHTML = '';
            document.getElementById('mainFolderDropdown').classList.remove('show');
            document.getElementById('apiOwnerDropdown').classList.remove('show');
            document.getElementById('apiOwnerSuggestion').innerHTML = '';
        }

        function editSuite(id) {
            const suite = customSuites.find(s => s.id === id);
            if (!suite) return;
            
            document.getElementById('mainFolderInput').value = suite.mainFolder;
            document.getElementById('subFolderInput').value = suite.subFolder;
            document.getElementById('apiOwnerInput').value = suite.apiOwner || '';
            document.getElementById('teamInput').value = suite.team || '';
            document.getElementById('descriptionInput').value = suite.description || '';
            document.getElementById('editSuiteId').value = suite.id;
            
            document.getElementById('suiteFormTitle').textContent = 'Edit API Suite';
            document.getElementById('submitSuiteBtn').innerHTML = '<span>ðŸ’¾</span> Update Suite';
            document.querySelector('.suite-mgmt-form-icon').textContent = 'âœï¸';
            
            // Scroll to form
            document.querySelector('.suite-mgmt-form-panel').scrollIntoView({ behavior: 'smooth' });
        }

        function deleteSuite(id) {
            showDeleteModal(id);
        }

        function renderSuitesTable(searchQuery = '') {
            const tbody = document.getElementById('suitesTableBody');
            const activeFilter = document.querySelector('.filter-tag.active')?.dataset.filter || 'all';
            
            let filtered = [...customSuites];
            
            // Apply folder filter
            if (activeFilter.startsWith('folder:')) {
                const folderName = activeFilter.replace('folder:', '');
                filtered = filtered.filter(s => s.mainFolder === folderName);
            }
            
            // Apply search
            if (searchQuery) {
                const q = searchQuery.toLowerCase();
                filtered = filtered.filter(s => 
                    s.mainFolder.toLowerCase().includes(q) ||
                    s.subFolder.toLowerCase().includes(q) ||
                    (s.apiOwner && s.apiOwner.toLowerCase().includes(q)) ||
                    (s.team && s.team.toLowerCase().includes(q))
                );
            }
            
            // Sort by current sort column
            filtered.sort((a, b) => {
                const aVal = (a[currentSortColumn] || '').toLowerCase();
                const bVal = (b[currentSortColumn] || '').toLowerCase();
                const compare = aVal.localeCompare(bVal);
                return currentSortDirection === 'asc' ? compare : -compare;
            });
            
            // Update count badge
            document.getElementById('suiteCountBadge').textContent = customSuites.length;
            
            if (filtered.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5">
                            <div class="suite-empty-table">
                                <div class="suite-empty-table-icon">${searchQuery ? 'ðŸ”' : 'ðŸ“­'}</div>
                                <h4>${searchQuery ? 'No Matching API Suites' : 'No API Suites Registered Yet'}</h4>
                                <p>${searchQuery ? 'Try a different search term' : 'Use the form to add your first API test suite'}</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = filtered.map(suite => `
                <tr>
                    <td>
                        <span class="suite-folder-badge">
                            ðŸ“ ${suite.mainFolder}
                        </span>
                    </td>
                    <td>
                        <span class="suite-subfolder-badge">
                            ðŸ“„ ${suite.subFolder}
                        </span>
                    </td>
                    <td>
                        <span class="owner-badge api">ðŸ”Œ ${suite.apiOwner}</span>
                    </td>
                    <td>
                        ${suite.team || '<span style="color: var(--text-muted)">â€”</span>'}
                    </td>
                    <td>
                        <div class="suite-actions-cell">
                            <button class="btn-edit-suite" onclick="editSuite('${suite.id}')" title="Edit">âœï¸</button>
                            <button class="btn-delete-suite" onclick="deleteSuite('${suite.id}')" title="Delete">ðŸ—‘ï¸</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function updateFilterTags() {
            // Group by main folder for quick filters
            const folders = [...new Set(customSuites.map(s => s.mainFolder))].sort();
            
            const filterTags = document.getElementById('suiteFilterTags');
            filterTags.innerHTML = `
                <span class="filter-tag active" data-filter="all">All (${customSuites.length})</span>
                ${folders.slice(0, 5).map(folder => `<span class="filter-tag" data-filter="folder:${folder}">ðŸ“ ${folder}</span>`).join('')}
            `;
        }

        function exportSuites() {
            if (customSuites.length === 0) {
                showToast('âš ï¸ No suites to export');
                return;
            }
            
            const data = JSON.stringify(customSuites, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `test-suites-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('ðŸ“¤ Suites exported successfully');
        }

        function closeImportModal() {
            document.getElementById('importModal').classList.remove('show');
            document.getElementById('importTextarea').value = '';
        }

        function importSuites() {
            const textarea = document.getElementById('importTextarea');
            const json = textarea.value.trim();
            
            if (!json) {
                showToast('âŒ Please paste JSON data');
                return;
            }
            
            try {
                const imported = JSON.parse(json);
                
                if (!Array.isArray(imported)) {
                    showToast('âŒ JSON must be an array');
                    return;
                }
                
                let addedCount = 0;
                let skippedCount = 0;
                
                let invalidFolderCount = 0;
                
                imported.forEach(item => {
                    if (!item.mainFolder || !item.subFolder || !item.apiOwner) {
                        skippedCount++;
                        return;
                    }
                    
                    // Validate main folder exists in API mapping
                    if (!isValidMainFolder(item.mainFolder)) {
                        invalidFolderCount++;
                        skippedCount++;
                        return;
                    }
                    
                    // Get correct case from valid folders
                    const correctFolder = validMainFolders.find(f => f.name.toLowerCase() === item.mainFolder.toLowerCase());
                    const normalizedFolder = correctFolder ? correctFolder.name : item.mainFolder;
                    
                    // Check for duplicates
                    const exists = customSuites.some(s => 
                        s.mainFolder.toLowerCase() === normalizedFolder.toLowerCase() && 
                        s.subFolder.toLowerCase() === item.subFolder.toLowerCase()
                    );
                    
                    if (exists) {
                        skippedCount++;
                        return;
                    }
                    
                    customSuites.push({
                        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                        mainFolder: normalizedFolder,
                        subFolder: item.subFolder,
                        apiOwner: item.apiOwner,
                        team: item.team || '',
                        description: item.description || '',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    });
                    addedCount++;
                });
                
                saveCustomSuites();
                renderSuitesTable();
                updateFilterTags();
                updateSuiteStats();
                closeImportModal();
                
                let skipMsg = '';
                if (skippedCount > 0) {
                    skipMsg = `, ${skippedCount} skipped`;
                    if (invalidFolderCount > 0) {
                        skipMsg += ` (${invalidFolderCount} invalid folders)`;
                    }
                }
                showToast(`ðŸ“¥ Imported ${addedCount} suites${skipMsg}`);
                
            } catch (e) {
                console.error('Import error:', e);
                showToast('âŒ Invalid JSON format');
            }
        }


    </script>
</body>
</html>